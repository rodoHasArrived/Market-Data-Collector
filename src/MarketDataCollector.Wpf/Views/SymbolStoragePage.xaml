<Page x:Class="MarketDataCollector.Wpf.Views.SymbolStoragePage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      Background="{DynamicResource ConsoleBackgroundDarkBrush}"
      Loaded="OnPageLoaded">
    <ScrollViewer VerticalScrollBarVisibility="Auto" Padding="24">
        <StackPanel MaxWidth="1200">

            <!-- Header -->
            <Grid Margin="0,0,0,24">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="Auto" />
                </Grid.ColumnDefinitions>
                <StackPanel Grid.Column="0">
                    <StackPanel Orientation="Horizontal" Margin="0,0,0,4">
                        <TextBlock Text="&#xE8A1;" FontFamily="{StaticResource SymbolThemeFontFamily}"
                                   FontSize="28" Foreground="{StaticResource InfoColorBrush}" VerticalAlignment="Center" />
                        <TextBlock Text="Symbol Storage" Style="{StaticResource PageTitleStyle}" Margin="12,0,0,0" VerticalAlignment="Center" />
                    </StackPanel>
                    <TextBlock Text="Per-symbol storage analytics, file breakdown, and data timeline"
                               Style="{StaticResource CardDescriptionStyle}" />
                </StackPanel>
                <Button Grid.Column="1" x:Name="RefreshButton" Click="Refresh_Click"
                        Style="{StaticResource SecondaryButtonStyle}" VerticalAlignment="Center">
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="&#xE72C;" FontFamily="{StaticResource SymbolThemeFontFamily}" FontSize="14" Margin="0,0,6,0" />
                        <TextBlock Text="Refresh" />
                    </StackPanel>
                </Button>
            </Grid>

            <!-- Summary Stats -->
            <Grid Margin="0,0,0,24">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" /><ColumnDefinition Width="16" />
                    <ColumnDefinition Width="*" /><ColumnDefinition Width="16" />
                    <ColumnDefinition Width="*" /><ColumnDefinition Width="16" />
                    <ColumnDefinition Width="*" />
                </Grid.ColumnDefinitions>
                <Border Grid.Column="0" Style="{StaticResource CardStyle}">
                    <StackPanel HorizontalAlignment="Center">
                        <TextBlock x:Name="TotalSizeText" Text="--" FontSize="28" FontWeight="Bold"
                                   Foreground="{StaticResource InfoColorBrush}" HorizontalAlignment="Center" />
                        <TextBlock Text="Total Size" HorizontalAlignment="Center" Foreground="{StaticResource ConsoleTextMutedBrush}" />
                    </StackPanel>
                </Border>
                <Border Grid.Column="2" Style="{StaticResource CardStyle}">
                    <StackPanel HorizontalAlignment="Center">
                        <TextBlock x:Name="TotalFilesText" Text="--" FontSize="28" FontWeight="Bold"
                                   Foreground="{StaticResource SuccessColorBrush}" HorizontalAlignment="Center" />
                        <TextBlock Text="Total Files" HorizontalAlignment="Center" Foreground="{StaticResource ConsoleTextMutedBrush}" />
                    </StackPanel>
                </Border>
                <Border Grid.Column="4" Style="{StaticResource CardStyle}">
                    <StackPanel HorizontalAlignment="Center">
                        <TextBlock x:Name="SymbolCountText" Text="--" FontSize="28" FontWeight="Bold"
                                   Foreground="{StaticResource WarningColorBrush}" HorizontalAlignment="Center" />
                        <TextBlock Text="Symbols" HorizontalAlignment="Center" Foreground="{StaticResource ConsoleTextMutedBrush}" />
                    </StackPanel>
                </Border>
                <Border Grid.Column="6" Style="{StaticResource CardStyle}">
                    <StackPanel HorizontalAlignment="Center">
                        <TextBlock x:Name="DailyGrowthText" Text="--" FontSize="28" FontWeight="Bold"
                                   Foreground="{StaticResource InfoColorBrush}" HorizontalAlignment="Center" />
                        <TextBlock Text="Daily Growth" HorizontalAlignment="Center" Foreground="{StaticResource ConsoleTextMutedBrush}" />
                    </StackPanel>
                </Border>
            </Grid>

            <!-- Data Type Breakdown -->
            <Border Style="{StaticResource CardStyle}" Margin="0,0,0,24">
                <StackPanel>
                    <TextBlock Text="Data Type Breakdown" Style="{StaticResource CardHeaderStyle}" Margin="0,0,0,16" />
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="16" />
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="16" />
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>
                        <Border Grid.Column="0" Background="{StaticResource ConsoleBackgroundLightBrush}" CornerRadius="6" Padding="16">
                            <StackPanel>
                                <TextBlock Text="Trade Data" FontSize="14" FontWeight="Bold" Foreground="{StaticResource ConsoleTextPrimaryBrush}" />
                                <TextBlock x:Name="TradeSizeText" Text="--" FontSize="20" FontWeight="Bold"
                                           Foreground="{StaticResource InfoColorBrush}" Margin="0,4,0,0" />
                                <TextBlock x:Name="TradeFilesText" Text="-- files" FontSize="12"
                                           Foreground="{StaticResource ConsoleTextMutedBrush}" />
                            </StackPanel>
                        </Border>
                        <Border Grid.Column="2" Background="{StaticResource ConsoleBackgroundLightBrush}" CornerRadius="6" Padding="16">
                            <StackPanel>
                                <TextBlock Text="Depth Data" FontSize="14" FontWeight="Bold" Foreground="{StaticResource ConsoleTextPrimaryBrush}" />
                                <TextBlock x:Name="DepthSizeText" Text="--" FontSize="20" FontWeight="Bold"
                                           Foreground="{StaticResource SuccessColorBrush}" Margin="0,4,0,0" />
                                <TextBlock x:Name="DepthFilesText" Text="-- files" FontSize="12"
                                           Foreground="{StaticResource ConsoleTextMutedBrush}" />
                            </StackPanel>
                        </Border>
                        <Border Grid.Column="4" Background="{StaticResource ConsoleBackgroundLightBrush}" CornerRadius="6" Padding="16">
                            <StackPanel>
                                <TextBlock Text="Historical Data" FontSize="14" FontWeight="Bold" Foreground="{StaticResource ConsoleTextPrimaryBrush}" />
                                <TextBlock x:Name="HistoricalSizeText" Text="--" FontSize="20" FontWeight="Bold"
                                           Foreground="{StaticResource WarningColorBrush}" Margin="0,4,0,0" />
                                <TextBlock x:Name="HistoricalFilesText" Text="-- files" FontSize="12"
                                           Foreground="{StaticResource ConsoleTextMutedBrush}" />
                            </StackPanel>
                        </Border>
                    </Grid>
                </StackPanel>
            </Border>

            <!-- Per-Symbol Breakdown -->
            <Border Style="{StaticResource CardStyle}" Margin="0,0,0,24">
                <StackPanel>
                    <TextBlock Text="Per-Symbol Breakdown" Style="{StaticResource CardHeaderStyle}" Margin="0,0,0,16" />
                    <ListView x:Name="SymbolList" SelectionMode="Single" MaxHeight="400"
                              Background="Transparent" BorderThickness="0">
                        <ListView.ItemContainerStyle>
                            <Style TargetType="ListViewItem">
                                <Setter Property="HorizontalContentAlignment" Value="Stretch" />
                                <Setter Property="Padding" Value="0" />
                                <Setter Property="Margin" Value="0,0,0,4" />
                                <Setter Property="Background" Value="Transparent" />
                            </Style>
                        </ListView.ItemContainerStyle>
                        <ListView.ItemTemplate>
                            <DataTemplate>
                                <Border Background="{StaticResource ConsoleBackgroundLightBrush}"
                                        CornerRadius="6" Padding="12,8"
                                        BorderBrush="{StaticResource ConsoleBorderBrush}" BorderThickness="1">
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="80" />
                                            <ColumnDefinition Width="120" />
                                            <ColumnDefinition Width="80" />
                                            <ColumnDefinition Width="*" />
                                            <ColumnDefinition Width="Auto" />
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Grid.Column="0" Text="{Binding Symbol}" FontSize="13" FontWeight="Bold"
                                                   Foreground="{StaticResource InfoColorBrush}" VerticalAlignment="Center" />
                                        <TextBlock Grid.Column="1" Text="{Binding SizeText}" FontSize="13"
                                                   Foreground="{StaticResource ConsoleTextPrimaryBrush}" VerticalAlignment="Center" />
                                        <TextBlock Grid.Column="2" Text="{Binding FileCountText}" FontSize="12"
                                                   Foreground="{StaticResource ConsoleTextMutedBrush}" VerticalAlignment="Center" />
                                        <ProgressBar Grid.Column="3" Value="{Binding PercentOfTotal}" Maximum="100" Height="6"
                                                     Foreground="{StaticResource InfoColorBrush}" Background="{StaticResource ConsoleBackgroundDarkBrush}"
                                                     VerticalAlignment="Center" Margin="12,0" />
                                        <TextBlock Grid.Column="4" Text="{Binding DateRangeText}" FontSize="11"
                                                   Foreground="{StaticResource ConsoleTextMutedBrush}" VerticalAlignment="Center" />
                                    </Grid>
                                </Border>
                            </DataTemplate>
                        </ListView.ItemTemplate>
                    </ListView>
                    <StackPanel x:Name="NoSymbolsPanel" Visibility="Collapsed" Margin="0,12,0,0">
                        <TextBlock Text="No symbol data found. Start collecting data to see per-symbol analytics."
                                   FontSize="13" Foreground="{StaticResource ConsoleTextMutedBrush}" HorizontalAlignment="Center" />
                    </StackPanel>
                </StackPanel>
            </Border>

            <!-- Disk Projection -->
            <Border x:Name="ProjectionPanel" Style="{StaticResource CardStyle}" Margin="0,0,0,24" Visibility="Collapsed">
                <StackPanel>
                    <TextBlock Text="Storage Projection" Style="{StaticResource CardHeaderStyle}" Margin="0,0,0,12" />
                    <TextBlock x:Name="ProjectionText" Text="" FontSize="13"
                               Foreground="{StaticResource ConsoleTextPrimaryBrush}" TextWrapping="Wrap" />
                </StackPanel>
            </Border>

            <!-- Loading -->
            <Border x:Name="LoadingPanel" Style="{StaticResource CardStyle}" Visibility="Collapsed">
                <StackPanel HorizontalAlignment="Center">
                    <ProgressBar IsIndeterminate="True" Height="4" Width="200" Margin="0,0,0,8"
                                 Foreground="{StaticResource InfoColorBrush}" />
                    <TextBlock Text="Analyzing storage..." FontSize="13"
                               Foreground="{StaticResource ConsoleTextMutedBrush}" HorizontalAlignment="Center" />
                </StackPanel>
            </Border>

        </StackPanel>
    </ScrollViewer>
</Page>
