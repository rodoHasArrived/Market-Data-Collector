<Page x:Class="MarketDataCollector.Wpf.Views.DataCalendarPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      Background="{DynamicResource ConsoleBackgroundDarkBrush}"
      Loaded="OnPageLoaded">
    <ScrollViewer VerticalScrollBarVisibility="Auto" Padding="24">
        <StackPanel MaxWidth="1200">
            <!-- Page Header -->
            <StackPanel Orientation="Horizontal" Margin="0,0,0,24">
                <TextBlock Text="&#xE787;" FontFamily="{StaticResource SymbolThemeFontFamily}"
                           FontSize="28" Foreground="{StaticResource InfoColorBrush}" VerticalAlignment="Center" />
                <TextBlock Text="Data Calendar" Style="{StaticResource PageTitleStyle}" Margin="12,0,0,0" VerticalAlignment="Center" />
            </StackPanel>

            <!-- Year Overview -->
            <Border Style="{StaticResource CardStyle}" Margin="0,0,0,16">
                <StackPanel>
                    <DockPanel Margin="0,0,0,12">
                        <TextBlock Text="Year Overview" Style="{StaticResource CardHeaderStyle}" VerticalAlignment="Center" />
                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                            <Button Content="&lt;" Style="{StaticResource PrimaryButtonStyle}"
                                    Click="PreviousYear_Click" Padding="8,4" Margin="0,0,4,0" />
                            <TextBlock x:Name="CurrentYearText" Text="2026" FontSize="16" FontWeight="Bold"
                                       Foreground="{StaticResource ConsoleTextPrimaryBrush}" VerticalAlignment="Center"
                                       Margin="8,0" />
                            <Button Content="&gt;" Style="{StaticResource PrimaryButtonStyle}"
                                    Click="NextYear_Click" Padding="8,4" Margin="4,0,0,0" />
                        </StackPanel>
                    </DockPanel>
                    <Grid Margin="0,0,0,8">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>
                        <StackPanel Grid.Column="0" Margin="0,0,12,0">
                            <TextBlock Text="Trading Days" Foreground="{StaticResource ConsoleTextMutedBrush}" FontSize="11" />
                            <TextBlock x:Name="TradingDaysText" Text="--" FontSize="20" FontWeight="Bold"
                                       Foreground="{StaticResource ConsoleTextPrimaryBrush}" />
                        </StackPanel>
                        <StackPanel Grid.Column="1" Margin="0,0,12,0">
                            <TextBlock Text="Days with Data" Foreground="{StaticResource ConsoleTextMutedBrush}" FontSize="11" />
                            <TextBlock x:Name="DaysWithDataText" Text="--" FontSize="20" FontWeight="Bold"
                                       Foreground="{StaticResource SuccessColorBrush}" />
                        </StackPanel>
                        <StackPanel Grid.Column="2" Margin="0,0,12,0">
                            <TextBlock Text="Gaps" Foreground="{StaticResource ConsoleTextMutedBrush}" FontSize="11" />
                            <TextBlock x:Name="TotalGapsText" Text="--" FontSize="20" FontWeight="Bold"
                                       Foreground="{StaticResource WarningColorBrush}" />
                        </StackPanel>
                        <StackPanel Grid.Column="3">
                            <TextBlock Text="Completeness" Foreground="{StaticResource ConsoleTextMutedBrush}" FontSize="11" />
                            <TextBlock x:Name="CompletenessText" Text="--" FontSize="20" FontWeight="Bold"
                                       Foreground="{StaticResource ConsoleTextPrimaryBrush}" />
                        </StackPanel>
                    </Grid>
                </StackPanel>
            </Border>

            <!-- Monthly Breakdown -->
            <Border Style="{StaticResource CardStyle}" Margin="0,0,0,16">
                <StackPanel>
                    <TextBlock Text="Monthly Breakdown" Style="{StaticResource CardHeaderStyle}" Margin="0,0,0,12" />
                    <TextBlock x:Name="MonthlyStatus" Text="Loading calendar data..."
                               Foreground="{StaticResource ConsoleTextMutedBrush}" Margin="0,0,0,8" />
                    <ItemsControl x:Name="MonthlyBreakdownList">
                        <ItemsControl.ItemTemplate>
                            <DataTemplate>
                                <Grid Margin="0,4">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="100" />
                                        <ColumnDefinition Width="*" />
                                        <ColumnDefinition Width="80" />
                                        <ColumnDefinition Width="80" />
                                        <ColumnDefinition Width="60" />
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Grid.Column="0" Text="{Binding MonthName}" FontWeight="SemiBold"
                                               Foreground="{StaticResource ConsoleTextPrimaryBrush}" />
                                    <ProgressBar Grid.Column="1" Value="{Binding Completeness}" Maximum="100"
                                                 Height="8" Margin="8,0"
                                                 Foreground="{StaticResource InfoColorBrush}"
                                                 Background="{StaticResource ConsoleBackgroundDarkBrush}" />
                                    <TextBlock Grid.Column="2" Text="{Binding DaysWithData, StringFormat='{}{0} days'}"
                                               Foreground="{StaticResource ConsoleTextMutedBrush}" HorizontalAlignment="Right" />
                                    <TextBlock Grid.Column="3" Text="{Binding GapCount, StringFormat='{}{0} gaps'}"
                                               Foreground="{StaticResource WarningColorBrush}" HorizontalAlignment="Right" />
                                    <TextBlock Grid.Column="4" Text="{Binding Completeness, StringFormat='{}{0:F0}%'}"
                                               Foreground="{StaticResource ConsoleTextMutedBrush}" HorizontalAlignment="Right" />
                                </Grid>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>
                </StackPanel>
            </Border>

            <!-- Legend -->
            <Border Style="{StaticResource CardStyle}">
                <StackPanel>
                    <TextBlock Text="Completeness Legend" Style="{StaticResource CardHeaderStyle}" Margin="0,0,0,12" />
                    <WrapPanel>
                        <StackPanel Orientation="Horizontal" Margin="0,0,16,4">
                            <Ellipse Width="10" Height="10" Fill="{StaticResource SuccessColorBrush}" VerticalAlignment="Center" />
                            <TextBlock Text="Complete (99-100%)" Foreground="{StaticResource ConsoleTextMutedBrush}" Margin="6,0,0,0" FontSize="11" />
                        </StackPanel>
                        <StackPanel Orientation="Horizontal" Margin="0,0,16,4">
                            <Ellipse Width="10" Height="10" Fill="{StaticResource InfoColorBrush}" VerticalAlignment="Center" />
                            <TextBlock Text="Good (95-98%)" Foreground="{StaticResource ConsoleTextMutedBrush}" Margin="6,0,0,0" FontSize="11" />
                        </StackPanel>
                        <StackPanel Orientation="Horizontal" Margin="0,0,16,4">
                            <Ellipse Width="10" Height="10" Fill="{StaticResource WarningColorBrush}" VerticalAlignment="Center" />
                            <TextBlock Text="Partial (50-94%)" Foreground="{StaticResource ConsoleTextMutedBrush}" Margin="6,0,0,0" FontSize="11" />
                        </StackPanel>
                        <StackPanel Orientation="Horizontal" Margin="0,0,16,4">
                            <Ellipse Width="10" Height="10" Fill="{StaticResource ErrorColorBrush}" VerticalAlignment="Center" />
                            <TextBlock Text="Missing (0-49%)" Foreground="{StaticResource ConsoleTextMutedBrush}" Margin="6,0,0,0" FontSize="11" />
                        </StackPanel>
                    </WrapPanel>
                </StackPanel>
            </Border>
        </StackPanel>
    </ScrollViewer>
</Page>
