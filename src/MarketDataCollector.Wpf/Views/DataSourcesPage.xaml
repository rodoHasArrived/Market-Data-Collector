<Page x:Class="MarketDataCollector.Wpf.Views.DataSourcesPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      Background="{DynamicResource ConsoleBackgroundDarkBrush}"
      Loaded="OnPageLoaded"
      Unloaded="OnPageUnloaded">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <Grid Grid.Row="0" Margin="24,24,24,16">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>

            <StackPanel Grid.Column="0" Orientation="Horizontal">
                <TextBlock Text="&#xE774;" FontFamily="{StaticResource SymbolThemeFontFamily}"
                           FontSize="28" Foreground="{StaticResource InfoColorBrush}"
                           VerticalAlignment="Center" />
                <TextBlock Text="Data Sources" Style="{StaticResource PageTitleStyle}"
                           Margin="12,0,0,0" VerticalAlignment="Center" />
            </StackPanel>

            <StackPanel Grid.Column="1" Orientation="Horizontal">
                <TextBlock x:Name="LastUpdatedText" Text="Last updated: --"
                           Foreground="{StaticResource ConsoleTextMutedBrush}"
                           VerticalAlignment="Center" Margin="0,0,16,0"/>
                <Button Content="Refresh" Click="Refresh_Click"
                        Background="{DynamicResource ConsoleBackgroundMediumBrush}"
                        Foreground="{DynamicResource ConsoleTextBrush}"
                        BorderThickness="0" Padding="16,8"/>
            </StackPanel>
        </Grid>

        <!-- Summary -->
        <Grid Grid.Row="1" Margin="24,0,24,16">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="16"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="16"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <Border Grid.Column="0" Style="{StaticResource CardStyle}">
                <StackPanel HorizontalAlignment="Center">
                    <TextBlock x:Name="StreamingCountText" Text="0"
                               FontSize="32" FontWeight="Bold"
                               Foreground="{StaticResource SuccessColorBrush}"
                               HorizontalAlignment="Center" />
                    <TextBlock Text="Streaming Providers"
                               HorizontalAlignment="Center"
                               Foreground="{StaticResource ConsoleTextMutedBrush}" />
                </StackPanel>
            </Border>

            <Border Grid.Column="2" Style="{StaticResource CardStyle}">
                <StackPanel HorizontalAlignment="Center">
                    <TextBlock x:Name="BackfillCountText" Text="0"
                               FontSize="32" FontWeight="Bold"
                               Foreground="{StaticResource InfoColorBrush}"
                               HorizontalAlignment="Center" />
                    <TextBlock Text="Backfill Providers"
                               HorizontalAlignment="Center"
                               Foreground="{StaticResource ConsoleTextMutedBrush}" />
                </StackPanel>
            </Border>

            <Border Grid.Column="4" Style="{StaticResource CardStyle}">
                <StackPanel HorizontalAlignment="Center">
                    <TextBlock x:Name="HybridCountText" Text="0"
                               FontSize="32" FontWeight="Bold"
                               Foreground="{StaticResource WarningColorBrush}"
                               HorizontalAlignment="Center" />
                    <TextBlock Text="Hybrid Providers"
                               HorizontalAlignment="Center"
                               Foreground="{StaticResource ConsoleTextMutedBrush}" />
                </StackPanel>
            </Border>
        </Grid>

        <!-- Provider Catalog -->
        <Border Grid.Row="2" Margin="24,0,24,24" Style="{StaticResource CardStyle}">
            <StackPanel>
                <Grid Margin="0,0,0,16">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    <TextBlock Text="Provider Catalog" Style="{StaticResource CardHeaderStyle}"/>
                    <TextBlock x:Name="ProviderCountText" Grid.Column="1" Text="0 providers"
                               Foreground="{StaticResource ConsoleTextMutedBrush}"
                               VerticalAlignment="Center"/>
                </Grid>

                <ListView x:Name="ProvidersList"
                          Background="Transparent"
                          BorderThickness="0"
                          ScrollViewer.HorizontalScrollBarVisibility="Disabled">
                    <ListView.ItemTemplate>
                        <DataTemplate>
                            <Grid Margin="0,6">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="180"/>
                                    <ColumnDefinition Width="120"/>
                                    <ColumnDefinition Width="140"/>
                                    <ColumnDefinition Width="120"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>

                                <TextBlock Grid.Column="0" Text="{Binding DisplayName}"
                                           Foreground="{StaticResource ConsoleTextPrimaryBrush}"
                                           FontWeight="SemiBold"/>
                                <TextBlock Grid.Column="1" Text="{Binding ProviderType}"
                                           Foreground="{StaticResource ConsoleTextMutedBrush}"/>
                                <TextBlock Grid.Column="2" Text="{Binding CredentialsText}"
                                           Foreground="{StaticResource ConsoleTextMutedBrush}"/>
                                <TextBlock Grid.Column="3" Text="{Binding StatusText}"
                                           Foreground="{Binding StatusBrush}"
                                           FontWeight="SemiBold"/>
                                <TextBlock Grid.Column="4" Text="{Binding Description}"
                                           Foreground="{StaticResource ConsoleTextMutedBrush}"
                                           TextWrapping="Wrap" Margin="8,0,0,0"/>
                            </Grid>
                        </DataTemplate>
                    </ListView.ItemTemplate>
                </ListView>

                <TextBlock x:Name="NoProvidersText"
                           Text="No providers available. Check your API connection."
                           Foreground="{StaticResource ConsoleTextMutedBrush}"
                           HorizontalAlignment="Center"
                           Margin="0,16,0,0"
                           Visibility="Collapsed"/>
            </StackPanel>
        </Border>
    </Grid>
</Page>
