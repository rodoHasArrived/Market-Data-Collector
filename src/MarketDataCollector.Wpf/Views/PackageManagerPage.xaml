<Page x:Class="MarketDataCollector.Wpf.Views.PackageManagerPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      Background="{DynamicResource ConsoleBackgroundDarkBrush}"
      Loaded="OnPageLoaded">
    <ScrollViewer VerticalScrollBarVisibility="Auto" Padding="24">
        <StackPanel MaxWidth="1200">
            <!-- Page Header -->
            <StackPanel Orientation="Horizontal" Margin="0,0,0,24">
                <TextBlock Text="&#xE7B8;" FontFamily="{StaticResource SymbolThemeFontFamily}"
                           FontSize="28" Foreground="{StaticResource InfoColorBrush}" VerticalAlignment="Center" />
                <TextBlock Text="Package Manager" Style="{StaticResource PageTitleStyle}" Margin="12,0,0,0" VerticalAlignment="Center" />
            </StackPanel>

            <!-- Create Package -->
            <Border Style="{StaticResource CardStyle}" Margin="0,0,0,16">
                <StackPanel>
                    <TextBlock Text="Create Data Package" Style="{StaticResource CardHeaderStyle}" Margin="0,0,0,12" />
                    <TextBlock Text="Create a portable data package containing collected market data for sharing or archival."
                               Foreground="{StaticResource ConsoleTextMutedBrush}" TextWrapping="Wrap" Margin="0,0,0,12" />
                    <Grid Margin="0,0,0,12">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>
                        <TextBlock Grid.Row="0" Grid.Column="0" Text="Symbols:"
                                   Foreground="{StaticResource ConsoleTextMutedBrush}" VerticalAlignment="Center"
                                   Margin="0,0,12,8" />
                        <TextBox Grid.Row="0" Grid.Column="1" x:Name="PackageSymbolsInput" Text="SPY,AAPL,MSFT"
                                 Foreground="{StaticResource ConsoleTextPrimaryBrush}"
                                 Background="{StaticResource ConsoleBackgroundDarkBrush}"
                                 BorderBrush="{StaticResource ConsoleTextMutedBrush}"
                                 Padding="8,6" Margin="0,0,0,8" />
                        <TextBlock Grid.Row="1" Grid.Column="0" Text="From:"
                                   Foreground="{StaticResource ConsoleTextMutedBrush}" VerticalAlignment="Center"
                                   Margin="0,0,12,8" />
                        <TextBox Grid.Row="1" Grid.Column="1" x:Name="PackageFromInput" Text=""
                                 Foreground="{StaticResource ConsoleTextPrimaryBrush}"
                                 Background="{StaticResource ConsoleBackgroundDarkBrush}"
                                 BorderBrush="{StaticResource ConsoleTextMutedBrush}"
                                 Padding="8,6" Margin="0,0,0,8" />
                        <TextBlock Grid.Row="2" Grid.Column="0" Text="To:"
                                   Foreground="{StaticResource ConsoleTextMutedBrush}" VerticalAlignment="Center"
                                   Margin="0,0,12,0" />
                        <TextBox Grid.Row="2" Grid.Column="1" x:Name="PackageToInput" Text=""
                                 Foreground="{StaticResource ConsoleTextPrimaryBrush}"
                                 Background="{StaticResource ConsoleBackgroundDarkBrush}"
                                 BorderBrush="{StaticResource ConsoleTextMutedBrush}"
                                 Padding="8,6" />
                    </Grid>
                    <StackPanel Orientation="Horizontal">
                        <Button Content="Create Package" Style="{StaticResource PrimaryButtonStyle}"
                                Click="CreatePackage_Click" Padding="16,8" Margin="0,0,8,0" />
                    </StackPanel>
                    <TextBlock x:Name="CreatePackageStatus" Text=""
                               Foreground="{StaticResource ConsoleTextMutedBrush}" Margin="0,8,0,0" TextWrapping="Wrap" />
                </StackPanel>
            </Border>

            <!-- Recent Packages -->
            <Border Style="{StaticResource CardStyle}" Margin="0,0,0,16">
                <StackPanel>
                    <DockPanel Margin="0,0,0,12">
                        <TextBlock Text="Recent Packages" Style="{StaticResource CardHeaderStyle}" VerticalAlignment="Center" />
                        <Button Content="Refresh" Style="{StaticResource PrimaryButtonStyle}"
                                Click="RefreshPackages_Click" HorizontalAlignment="Right" Padding="12,6" />
                    </DockPanel>
                    <TextBlock x:Name="PackageListStatus" Text="Loading packages..."
                               Foreground="{StaticResource ConsoleTextMutedBrush}" Margin="0,0,0,8" />
                    <ItemsControl x:Name="PackageList">
                        <ItemsControl.ItemTemplate>
                            <DataTemplate>
                                <Border BorderBrush="{StaticResource ConsoleTextMutedBrush}" BorderThickness="0,0,0,1"
                                        Padding="0,8" Margin="0,0,0,4">
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*" />
                                            <ColumnDefinition Width="Auto" />
                                        </Grid.ColumnDefinitions>
                                        <StackPanel Grid.Column="0">
                                            <TextBlock Text="{Binding Name}" FontWeight="SemiBold"
                                                       Foreground="{StaticResource ConsoleTextPrimaryBrush}" />
                                            <TextBlock Foreground="{StaticResource ConsoleTextMutedBrush}" FontSize="11">
                                                <Run Text="{Binding CreatedAt, StringFormat='{}{0:yyyy-MM-dd HH:mm}'}" />
                                                <Run Text=" | " />
                                                <Run Text="{Binding SizeBytes, StringFormat='{}{0:N0} bytes'}" />
                                            </TextBlock>
                                        </StackPanel>
                                        <TextBlock Grid.Column="1" Text="{Binding Path}"
                                                   Foreground="{StaticResource ConsoleTextMutedBrush}" Margin="12,0,0,0"
                                                   VerticalAlignment="Center" MaxWidth="300" TextTrimming="CharacterEllipsis" />
                                    </Grid>
                                </Border>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>
                </StackPanel>
            </Border>

            <!-- Validate Package -->
            <Border Style="{StaticResource CardStyle}" Margin="0,0,0,16">
                <StackPanel>
                    <TextBlock Text="Validate Package" Style="{StaticResource CardHeaderStyle}" Margin="0,0,0,12" />
                    <DockPanel Margin="0,0,0,8">
                        <Button Content="Validate" Style="{StaticResource PrimaryButtonStyle}"
                                Click="ValidatePackage_Click" DockPanel.Dock="Right" Padding="12,6" Margin="8,0,0,0" />
                        <TextBox x:Name="ValidatePackageInput" Text=""
                                 Foreground="{StaticResource ConsoleTextPrimaryBrush}"
                                 Background="{StaticResource ConsoleBackgroundDarkBrush}"
                                 BorderBrush="{StaticResource ConsoleTextMutedBrush}"
                                 Padding="8,6" />
                    </DockPanel>
                    <TextBlock x:Name="ValidatePackageResult" Text=""
                               Foreground="{StaticResource ConsoleTextMutedBrush}" TextWrapping="Wrap" />
                </StackPanel>
            </Border>

            <!-- Import Package -->
            <Border Style="{StaticResource CardStyle}">
                <StackPanel>
                    <TextBlock Text="Import Package" Style="{StaticResource CardHeaderStyle}" Margin="0,0,0,12" />
                    <TextBlock Text="Import a portable data package into your local storage."
                               Foreground="{StaticResource ConsoleTextMutedBrush}" TextWrapping="Wrap" Margin="0,0,0,12" />
                    <DockPanel Margin="0,0,0,8">
                        <Button Content="Import" Style="{StaticResource PrimaryButtonStyle}"
                                Click="ImportPackage_Click" DockPanel.Dock="Right" Padding="12,6" Margin="8,0,0,0" />
                        <TextBox x:Name="ImportPackageInput" Text=""
                                 Foreground="{StaticResource ConsoleTextPrimaryBrush}"
                                 Background="{StaticResource ConsoleBackgroundDarkBrush}"
                                 BorderBrush="{StaticResource ConsoleTextMutedBrush}"
                                 Padding="8,6" />
                    </DockPanel>
                    <TextBlock x:Name="ImportPackageResult" Text=""
                               Foreground="{StaticResource ConsoleTextMutedBrush}" TextWrapping="Wrap" />
                </StackPanel>
            </Border>
        </StackPanel>
    </ScrollViewer>
</Page>
