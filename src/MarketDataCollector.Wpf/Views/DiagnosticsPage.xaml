<Page x:Class="MarketDataCollector.Wpf.Views.DiagnosticsPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      Background="{DynamicResource ConsoleBackgroundDarkBrush}"
      Loaded="OnPageLoaded">
    <ScrollViewer VerticalScrollBarVisibility="Auto" Padding="24">
        <StackPanel MaxWidth="1200">

            <!-- Header -->
            <StackPanel Orientation="Horizontal" Margin="0,0,0,24">
                <TextBlock Text="&#xE9D9;" FontFamily="{StaticResource SymbolThemeFontFamily}"
                           FontSize="28" Foreground="{StaticResource InfoColorBrush}" VerticalAlignment="Center" />
                <TextBlock Text="Diagnostics" Style="{StaticResource PageTitleStyle}" Margin="12,0,0,0" VerticalAlignment="Center" />
            </StackPanel>

            <!-- System Information Card -->
            <Border Style="{StaticResource CardStyle}" Margin="0,0,0,16">
                <StackPanel>
                    <TextBlock Text="System Information" Style="{StaticResource CardHeaderStyle}" Margin="0,0,0,16" />

                    <!-- Application Version -->
                    <Grid Margin="0,0,0,10">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="180" />
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>
                        <TextBlock Grid.Column="0" Text="Application Version"
                                   Foreground="{StaticResource ConsoleTextSecondaryBrush}" />
                        <TextBlock Grid.Column="1" Text="1.6.1"
                                   Foreground="{StaticResource ConsoleTextPrimaryBrush}" FontWeight="SemiBold" />
                    </Grid>

                    <!-- .NET Runtime -->
                    <Grid Margin="0,0,0,10">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="180" />
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>
                        <TextBlock Grid.Column="0" Text=".NET Runtime"
                                   Foreground="{StaticResource ConsoleTextSecondaryBrush}" />
                        <TextBlock x:Name="RuntimeVersionText" Grid.Column="1" Text="--"
                                   Foreground="{StaticResource ConsoleTextPrimaryBrush}" FontWeight="SemiBold" />
                    </Grid>

                    <!-- OS -->
                    <Grid Margin="0,0,0,10">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="180" />
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>
                        <TextBlock Grid.Column="0" Text="OS"
                                   Foreground="{StaticResource ConsoleTextSecondaryBrush}" />
                        <TextBlock x:Name="OsVersionText" Grid.Column="1" Text="--"
                                   Foreground="{StaticResource ConsoleTextPrimaryBrush}" FontWeight="SemiBold" />
                    </Grid>

                    <!-- Working Directory -->
                    <Grid Margin="0,0,0,10">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="180" />
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>
                        <TextBlock Grid.Column="0" Text="Working Directory"
                                   Foreground="{StaticResource ConsoleTextSecondaryBrush}" />
                        <TextBlock x:Name="WorkingDirectoryText" Grid.Column="1" Text="--"
                                   Foreground="{StaticResource ConsoleTextPrimaryBrush}" FontWeight="SemiBold"
                                   TextTrimming="CharacterEllipsis" />
                    </Grid>

                    <!-- Process ID -->
                    <Grid Margin="0,0,0,10">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="180" />
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>
                        <TextBlock Grid.Column="0" Text="Process ID"
                                   Foreground="{StaticResource ConsoleTextSecondaryBrush}" />
                        <TextBlock x:Name="ProcessIdText" Grid.Column="1" Text="--"
                                   Foreground="{StaticResource ConsoleTextPrimaryBrush}" FontWeight="SemiBold" />
                    </Grid>

                    <!-- Memory Usage -->
                    <Grid Margin="0,0,0,0">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="180" />
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>
                        <TextBlock Grid.Column="0" Text="Memory Usage"
                                   Foreground="{StaticResource ConsoleTextSecondaryBrush}" />
                        <TextBlock x:Name="MemoryUsageText" Grid.Column="1" Text="--"
                                   Foreground="{StaticResource ConsoleTextPrimaryBrush}" FontWeight="SemiBold" />
                    </Grid>
                </StackPanel>
            </Border>

            <!-- Configuration Check Card -->
            <Border Style="{StaticResource CardStyle}" Margin="0,0,0,16">
                <StackPanel>
                    <TextBlock Text="Configuration Check" Style="{StaticResource CardHeaderStyle}" Margin="0,0,0,16" />

                    <!-- Configuration File -->
                    <Grid Margin="0,0,0,10">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="180" />
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>
                        <Ellipse x:Name="ConfigStatusDot" Grid.Column="0"
                                 Width="10" Height="10"
                                 Fill="{StaticResource ConsoleTextMutedBrush}"
                                 VerticalAlignment="Center" Margin="0,0,10,0" />
                        <TextBlock Grid.Column="1" Text="Configuration File"
                                   Foreground="{StaticResource ConsoleTextSecondaryBrush}"
                                   VerticalAlignment="Center" />
                        <TextBlock x:Name="ConfigStatusText" Grid.Column="2" Text="Not checked"
                                   Foreground="{StaticResource ConsoleTextMutedBrush}"
                                   VerticalAlignment="Center" />
                    </Grid>

                    <!-- Storage Path -->
                    <Grid Margin="0,0,0,10">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="180" />
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>
                        <Ellipse x:Name="StorageStatusDot" Grid.Column="0"
                                 Width="10" Height="10"
                                 Fill="{StaticResource ConsoleTextMutedBrush}"
                                 VerticalAlignment="Center" Margin="0,0,10,0" />
                        <TextBlock Grid.Column="1" Text="Storage Path"
                                   Foreground="{StaticResource ConsoleTextSecondaryBrush}"
                                   VerticalAlignment="Center" />
                        <TextBlock x:Name="StorageStatusText" Grid.Column="2" Text="Not checked"
                                   Foreground="{StaticResource ConsoleTextMutedBrush}"
                                   VerticalAlignment="Center" />
                    </Grid>

                    <!-- API Connectivity -->
                    <Grid Margin="0,0,0,10">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="180" />
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>
                        <Ellipse x:Name="ApiStatusDot" Grid.Column="0"
                                 Width="10" Height="10"
                                 Fill="{StaticResource ConsoleTextMutedBrush}"
                                 VerticalAlignment="Center" Margin="0,0,10,0" />
                        <TextBlock Grid.Column="1" Text="API Connectivity"
                                   Foreground="{StaticResource ConsoleTextSecondaryBrush}"
                                   VerticalAlignment="Center" />
                        <TextBlock x:Name="ApiStatusText" Grid.Column="2" Text="Not checked"
                                   Foreground="{StaticResource ConsoleTextMutedBrush}"
                                   VerticalAlignment="Center" />
                    </Grid>

                    <!-- Provider Configuration -->
                    <Grid Margin="0,0,0,0">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="180" />
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>
                        <Ellipse x:Name="ProviderStatusDot" Grid.Column="0"
                                 Width="10" Height="10"
                                 Fill="{StaticResource ConsoleTextMutedBrush}"
                                 VerticalAlignment="Center" Margin="0,0,10,0" />
                        <TextBlock Grid.Column="1" Text="Provider Configuration"
                                   Foreground="{StaticResource ConsoleTextSecondaryBrush}"
                                   VerticalAlignment="Center" />
                        <TextBlock x:Name="ProviderStatusText" Grid.Column="2" Text="Not checked"
                                   Foreground="{StaticResource ConsoleTextMutedBrush}"
                                   VerticalAlignment="Center" />
                    </Grid>
                </StackPanel>
            </Border>

            <!-- Actions Card -->
            <Border Style="{StaticResource CardStyle}" Margin="0,0,0,16">
                <StackPanel>
                    <TextBlock Text="Actions" Style="{StaticResource CardHeaderStyle}" Margin="0,0,0,16" />
                    <WrapPanel Orientation="Horizontal">
                        <Button Style="{StaticResource PrimaryButtonStyle}"
                                Click="RunQuickCheck_Click"
                                Margin="0,0,8,8">
                            <StackPanel Orientation="Horizontal">
                                <TextBlock Text="&#xE9D9;" FontFamily="{StaticResource SymbolThemeFontFamily}"
                                           FontSize="14" Margin="0,0,6,0" VerticalAlignment="Center" />
                                <TextBlock Text="Run Quick Check" VerticalAlignment="Center" />
                            </StackPanel>
                        </Button>
                        <Button Style="{StaticResource SecondaryButtonStyle}"
                                Click="RunFullDiagnostics_Click"
                                Margin="0,0,8,8">
                            <StackPanel Orientation="Horizontal">
                                <TextBlock Text="&#xE9F5;" FontFamily="{StaticResource SymbolThemeFontFamily}"
                                           FontSize="14" Margin="0,0,6,0" VerticalAlignment="Center" />
                                <TextBlock Text="Run Full Diagnostics" VerticalAlignment="Center" />
                            </StackPanel>
                        </Button>
                        <Button Style="{StaticResource SecondaryButtonStyle}"
                                Click="ExportBundle_Click"
                                Margin="0,0,8,8">
                            <StackPanel Orientation="Horizontal">
                                <TextBlock Text="&#xE896;" FontFamily="{StaticResource SymbolThemeFontFamily}"
                                           FontSize="14" Margin="0,0,6,0" VerticalAlignment="Center" />
                                <TextBlock Text="Export Diagnostic Bundle" VerticalAlignment="Center" />
                            </StackPanel>
                        </Button>
                        <Button Style="{StaticResource GhostButtonStyle}"
                                Click="OpenLogsFolder_Click"
                                Margin="0,0,0,8">
                            <StackPanel Orientation="Horizontal">
                                <TextBlock Text="&#xE838;" FontFamily="{StaticResource SymbolThemeFontFamily}"
                                           FontSize="14" Margin="0,0,6,0" VerticalAlignment="Center" />
                                <TextBlock Text="Open Logs Folder" VerticalAlignment="Center" />
                            </StackPanel>
                        </Button>
                    </WrapPanel>
                </StackPanel>
            </Border>

            <!-- Diagnostic Output Card -->
            <Border Style="{StaticResource CardStyle}" Margin="0,0,0,24">
                <StackPanel>
                    <TextBlock Text="Diagnostic Output" Style="{StaticResource CardHeaderStyle}" Margin="0,0,0,16" />
                    <Border Background="{DynamicResource ConsoleBackgroundMediumBrush}"
                            CornerRadius="4" Padding="2">
                        <TextBox x:Name="DiagnosticOutputText"
                                 IsReadOnly="True"
                                 AcceptsReturn="True"
                                 TextWrapping="Wrap"
                                 VerticalScrollBarVisibility="Auto"
                                 MinHeight="200"
                                 MaxHeight="500"
                                 FontFamily="Cascadia Mono, Consolas, Courier New, monospace"
                                 FontSize="13"
                                 Foreground="{StaticResource ConsoleTextPrimaryBrush}"
                                 Background="{DynamicResource ConsoleBackgroundMediumBrush}"
                                 BorderThickness="0"
                                 Padding="12"
                                 Text="Run a diagnostic check to see output here." />
                    </Border>
                </StackPanel>
            </Border>

        </StackPanel>
    </ScrollViewer>
</Page>
