<?xml version="1.0" encoding="utf-8"?>
<ContentDialog
    x:Class="MarketDataCollector.Uwp.Dialogs.BackfillWizardDialog"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:MarketDataCollector.Uwp.Dialogs"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d"
    Title="Backfill Wizard"
    PrimaryButtonText="Next"
    SecondaryButtonText="Cancel"
    DefaultButton="Primary"
    PrimaryButtonClick="PrimaryButton_Click"
    SecondaryButtonClick="SecondaryButton_Click"
    MinWidth="700"
    MinHeight="500">

    <Grid Width="650">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>

        <!-- Progress Steps -->
        <Border Grid.Row="0" Padding="0,0,0,24">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="*" />
                </Grid.ColumnDefinitions>

                <!-- Step 1: Symbols -->
                <StackPanel Grid.Column="0" HorizontalAlignment="Center" Spacing="8">
                    <Border x:Name="Step1Circle" Width="36" Height="36" CornerRadius="18"
                            Background="{ThemeResource SystemAccentColor}" HorizontalAlignment="Center">
                        <TextBlock Text="1" Foreground="White" FontWeight="Bold"
                                   HorizontalAlignment="Center" VerticalAlignment="Center" />
                    </Border>
                    <TextBlock x:Name="Step1Text" Text="Symbols" FontWeight="SemiBold"
                               HorizontalAlignment="Center" FontSize="12" />
                </StackPanel>

                <!-- Step 2: Date Range -->
                <StackPanel Grid.Column="1" HorizontalAlignment="Center" Spacing="8">
                    <Border x:Name="Step2Circle" Width="36" Height="36" CornerRadius="18"
                            Background="{ThemeResource SystemBaseMediumLowColor}" HorizontalAlignment="Center">
                        <TextBlock Text="2" Foreground="White" FontWeight="Bold"
                                   HorizontalAlignment="Center" VerticalAlignment="Center" />
                    </Border>
                    <TextBlock x:Name="Step2Text" Text="Date Range"
                               HorizontalAlignment="Center" FontSize="12"
                               Foreground="{ThemeResource SystemBaseMediumColor}" />
                </StackPanel>

                <!-- Step 3: Provider -->
                <StackPanel Grid.Column="2" HorizontalAlignment="Center" Spacing="8">
                    <Border x:Name="Step3Circle" Width="36" Height="36" CornerRadius="18"
                            Background="{ThemeResource SystemBaseMediumLowColor}" HorizontalAlignment="Center">
                        <TextBlock Text="3" Foreground="White" FontWeight="Bold"
                                   HorizontalAlignment="Center" VerticalAlignment="Center" />
                    </Border>
                    <TextBlock x:Name="Step3Text" Text="Provider"
                               HorizontalAlignment="Center" FontSize="12"
                               Foreground="{ThemeResource SystemBaseMediumColor}" />
                </StackPanel>

                <!-- Step 4: Review -->
                <StackPanel Grid.Column="3" HorizontalAlignment="Center" Spacing="8">
                    <Border x:Name="Step4Circle" Width="36" Height="36" CornerRadius="18"
                            Background="{ThemeResource SystemBaseMediumLowColor}" HorizontalAlignment="Center">
                        <TextBlock Text="4" Foreground="White" FontWeight="Bold"
                                   HorizontalAlignment="Center" VerticalAlignment="Center" />
                    </Border>
                    <TextBlock x:Name="Step4Text" Text="Review"
                               HorizontalAlignment="Center" FontSize="12"
                               Foreground="{ThemeResource SystemBaseMediumColor}" />
                </StackPanel>
            </Grid>
        </Border>

        <!-- Step Content -->
        <Grid Grid.Row="1">
            <!-- Step 1: Symbol Selection -->
            <StackPanel x:Name="Step1Panel" Spacing="16">
                <TextBlock Text="What symbols would you like to download data for?"
                           Style="{StaticResource SubtitleTextBlockStyle}" />
                <TextBlock Text="Enter stock ticker symbols separated by commas, or choose from the suggestions below."
                           Foreground="{ThemeResource SystemBaseMediumColor}" TextWrapping="Wrap" />

                <AutoSuggestBox x:Name="SymbolSearchBox"
                                PlaceholderText="Search symbols (e.g., AAPL, MSFT, TSLA)"
                                QueryIcon="Find"
                                TextChanged="SymbolSearchBox_TextChanged"
                                QuerySubmitted="SymbolSearchBox_QuerySubmitted" />

                <!-- Selected Symbols -->
                <StackPanel Spacing="8">
                    <TextBlock Text="Selected Symbols:" FontWeight="SemiBold" />
                    <ItemsControl x:Name="SelectedSymbolsPanel">
                        <ItemsControl.ItemsPanel>
                            <ItemsPanelTemplate>
                                <ItemsWrapGrid Orientation="Horizontal" MaxWidth="650" />
                            </ItemsPanelTemplate>
                        </ItemsControl.ItemsPanel>
                        <ItemsControl.ItemTemplate>
                            <DataTemplate>
                                <Border Background="{ThemeResource SystemAccentColorLight2}"
                                        CornerRadius="4" Padding="8,4" Margin="0,0,8,8">
                                    <StackPanel Orientation="Horizontal" Spacing="8">
                                        <TextBlock Text="{Binding}" VerticalAlignment="Center" />
                                        <Button Content="X" Padding="4,0" FontSize="10"
                                                Background="Transparent"
                                                Click="RemoveSymbol_Click" Tag="{Binding}" />
                                    </StackPanel>
                                </Border>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>
                    <TextBlock x:Name="NoSymbolsText" Text="No symbols selected"
                               Foreground="{ThemeResource SystemBaseMediumColor}"
                               FontStyle="Italic" />
                </StackPanel>

                <!-- Quick Add Presets -->
                <StackPanel Spacing="8">
                    <TextBlock Text="Quick Add:" FontWeight="SemiBold" />
                    <StackPanel Orientation="Horizontal" Spacing="8">
                        <Button Click="AddMajorIndices_Click">
                            <StackPanel Orientation="Horizontal" Spacing="4">
                                <FontIcon Glyph="&#xE8D2;" FontSize="14" />
                                <TextBlock Text="Major ETFs" />
                            </StackPanel>
                        </Button>
                        <Button Click="AddTechStocks_Click">
                            <StackPanel Orientation="Horizontal" Spacing="4">
                                <FontIcon Glyph="&#xE8F1;" FontSize="14" />
                                <TextBlock Text="Tech Giants" />
                            </StackPanel>
                        </Button>
                        <Button Click="AddMagnificent7_Click">
                            <StackPanel Orientation="Horizontal" Spacing="4">
                                <FontIcon Glyph="&#xE734;" FontSize="14" />
                                <TextBlock Text="Magnificent 7" />
                            </StackPanel>
                        </Button>
                        <Button Click="AddSubscribed_Click">
                            <StackPanel Orientation="Horizontal" Spacing="4">
                                <FontIcon Glyph="&#xE8EC;" FontSize="14" />
                                <TextBlock Text="My Subscribed" />
                            </StackPanel>
                        </Button>
                    </StackPanel>
                </StackPanel>

                <!-- Popular Symbols -->
                <StackPanel Spacing="8">
                    <TextBlock Text="Popular Symbols:" FontWeight="SemiBold" />
                    <ItemsControl x:Name="PopularSymbolsList">
                        <ItemsControl.ItemsPanel>
                            <ItemsPanelTemplate>
                                <ItemsWrapGrid Orientation="Horizontal" MaxWidth="650" />
                            </ItemsPanelTemplate>
                        </ItemsControl.ItemsPanel>
                        <ItemsControl.ItemTemplate>
                            <DataTemplate>
                                <Button Margin="0,0,8,8" Padding="12,6"
                                        Click="PopularSymbol_Click" Tag="{Binding}">
                                    <TextBlock Text="{Binding}" />
                                </Button>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>
                </StackPanel>
            </StackPanel>

            <!-- Step 2: Date Range Selection -->
            <StackPanel x:Name="Step2Panel" Spacing="16" Visibility="Collapsed">
                <TextBlock Text="Select the date range for historical data"
                           Style="{StaticResource SubtitleTextBlockStyle}" />
                <TextBlock Text="Choose how far back you want to download data. More data takes longer but provides better historical coverage."
                           Foreground="{ThemeResource SystemBaseMediumColor}" TextWrapping="Wrap" />

                <!-- Quick Presets -->
                <StackPanel Spacing="12">
                    <TextBlock Text="Quick Select:" FontWeight="SemiBold" />
                    <Grid ColumnSpacing="12" RowSpacing="12">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>

                        <Button x:Name="Range30Days" Grid.Row="0" Grid.Column="0"
                                HorizontalAlignment="Stretch" Click="DatePreset_Click" Tag="30">
                            <StackPanel Spacing="4">
                                <TextBlock Text="Last 30 Days" FontWeight="SemiBold" HorizontalAlignment="Center" />
                                <TextBlock Text="~22 trading days" FontSize="11"
                                           Foreground="{ThemeResource SystemBaseMediumColor}"
                                           HorizontalAlignment="Center" />
                            </StackPanel>
                        </Button>

                        <Button x:Name="Range90Days" Grid.Row="0" Grid.Column="1"
                                HorizontalAlignment="Stretch" Click="DatePreset_Click" Tag="90">
                            <StackPanel Spacing="4">
                                <TextBlock Text="Last 90 Days" FontWeight="SemiBold" HorizontalAlignment="Center" />
                                <TextBlock Text="~63 trading days" FontSize="11"
                                           Foreground="{ThemeResource SystemBaseMediumColor}"
                                           HorizontalAlignment="Center" />
                            </StackPanel>
                        </Button>

                        <Button x:Name="RangeYTD" Grid.Row="0" Grid.Column="2"
                                HorizontalAlignment="Stretch" Click="DatePreset_Click" Tag="YTD">
                            <StackPanel Spacing="4">
                                <TextBlock Text="Year to Date" FontWeight="SemiBold" HorizontalAlignment="Center" />
                                <TextBlock x:Name="YtdDaysText" Text="~X trading days" FontSize="11"
                                           Foreground="{ThemeResource SystemBaseMediumColor}"
                                           HorizontalAlignment="Center" />
                            </StackPanel>
                        </Button>

                        <Button x:Name="Range1Year" Grid.Row="1" Grid.Column="0"
                                HorizontalAlignment="Stretch" Click="DatePreset_Click" Tag="365"
                                Style="{StaticResource AccentButtonStyle}">
                            <StackPanel Spacing="4">
                                <StackPanel Orientation="Horizontal" Spacing="4" HorizontalAlignment="Center">
                                    <FontIcon Glyph="&#xE735;" FontSize="12" />
                                    <TextBlock Text="1 Year" FontWeight="SemiBold" />
                                </StackPanel>
                                <TextBlock Text="~252 trading days (Recommended)" FontSize="11" HorizontalAlignment="Center" />
                            </StackPanel>
                        </Button>

                        <Button x:Name="Range3Years" Grid.Row="1" Grid.Column="1"
                                HorizontalAlignment="Stretch" Click="DatePreset_Click" Tag="1095">
                            <StackPanel Spacing="4">
                                <TextBlock Text="3 Years" FontWeight="SemiBold" HorizontalAlignment="Center" />
                                <TextBlock Text="~756 trading days" FontSize="11"
                                           Foreground="{ThemeResource SystemBaseMediumColor}"
                                           HorizontalAlignment="Center" />
                            </StackPanel>
                        </Button>

                        <Button x:Name="Range5Years" Grid.Row="1" Grid.Column="2"
                                HorizontalAlignment="Stretch" Click="DatePreset_Click" Tag="1825">
                            <StackPanel Spacing="4">
                                <TextBlock Text="5 Years" FontWeight="SemiBold" HorizontalAlignment="Center" />
                                <TextBlock Text="~1,260 trading days" FontSize="11"
                                           Foreground="{ThemeResource SystemBaseMediumColor}"
                                           HorizontalAlignment="Center" />
                            </StackPanel>
                        </Button>
                    </Grid>
                </StackPanel>

                <!-- Custom Date Range -->
                <StackPanel Spacing="12">
                    <TextBlock Text="Or choose custom dates:" FontWeight="SemiBold" />
                    <Grid ColumnSpacing="16">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>
                        <CalendarDatePicker x:Name="WizardFromDate"
                                            Header="From Date"
                                            HorizontalAlignment="Stretch"
                                            DateChanged="CustomDate_Changed" />
                        <CalendarDatePicker x:Name="WizardToDate"
                                            Grid.Column="1"
                                            Header="To Date"
                                            HorizontalAlignment="Stretch"
                                            DateChanged="CustomDate_Changed" />
                    </Grid>
                </StackPanel>

                <!-- Date Summary -->
                <Border Background="{ThemeResource SystemFillColorNeutralBackgroundBrush}"
                        CornerRadius="8" Padding="16">
                    <Grid ColumnSpacing="24">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>
                        <StackPanel Grid.Column="0" Spacing="4">
                            <TextBlock Text="From" Style="{StaticResource CaptionTextBlockStyle}"
                                       Foreground="{ThemeResource SystemBaseMediumColor}" />
                            <TextBlock x:Name="SummaryFromDate" Text="--" FontWeight="SemiBold" />
                        </StackPanel>
                        <StackPanel Grid.Column="1" Spacing="4">
                            <TextBlock Text="To" Style="{StaticResource CaptionTextBlockStyle}"
                                       Foreground="{ThemeResource SystemBaseMediumColor}" />
                            <TextBlock x:Name="SummaryToDate" Text="--" FontWeight="SemiBold" />
                        </StackPanel>
                        <StackPanel Grid.Column="2" Spacing="4">
                            <TextBlock Text="Est. Trading Days" Style="{StaticResource CaptionTextBlockStyle}"
                                       Foreground="{ThemeResource SystemBaseMediumColor}" />
                            <TextBlock x:Name="SummaryTradingDays" Text="--" FontWeight="SemiBold"
                                       Foreground="{ThemeResource SystemAccentColor}" />
                        </StackPanel>
                    </Grid>
                </Border>
            </StackPanel>

            <!-- Step 3: Provider Selection -->
            <StackPanel x:Name="Step3Panel" Spacing="16" Visibility="Collapsed">
                <TextBlock Text="Choose a data provider"
                           Style="{StaticResource SubtitleTextBlockStyle}" />
                <TextBlock Text="Select where to download the historical data from. Multi-Source automatically tries multiple providers for best coverage."
                           Foreground="{ThemeResource SystemBaseMediumColor}" TextWrapping="Wrap" />

                <!-- Provider Options -->
                <StackPanel Spacing="8">
                    <RadioButton x:Name="ProviderMultiSource" GroupName="Provider" IsChecked="True">
                        <Border Background="{ThemeResource SystemFillColorNeutralBackgroundBrush}"
                                CornerRadius="8" Padding="16" Width="600">
                            <Grid ColumnSpacing="16">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>
                                <FontIcon Glyph="&#xE735;" FontSize="28" Foreground="{ThemeResource SystemAccentColor}" />
                                <StackPanel Grid.Column="1" Spacing="4">
                                    <TextBlock Text="Multi-Source (Recommended)" FontWeight="SemiBold" />
                                    <TextBlock Text="Automatically tries Yahoo Finance, Stooq, and other providers. Best data coverage with automatic failover."
                                               TextWrapping="Wrap" FontSize="12"
                                               Foreground="{ThemeResource SystemBaseMediumColor}" />
                                </StackPanel>
                                <Border Grid.Column="2" Background="#48BB7840" CornerRadius="4" Padding="8,4">
                                    <TextBlock Text="Best Coverage" FontSize="11" Foreground="#48BB78" />
                                </Border>
                            </Grid>
                        </Border>
                    </RadioButton>

                    <RadioButton x:Name="ProviderYahoo" GroupName="Provider">
                        <Border Background="{ThemeResource SystemFillColorNeutralBackgroundBrush}"
                                CornerRadius="8" Padding="16" Width="600">
                            <Grid ColumnSpacing="16">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>
                                <FontIcon Glyph="&#xE774;" FontSize="28" Foreground="#6001D2" />
                                <StackPanel Grid.Column="1" Spacing="4">
                                    <TextBlock Text="Yahoo Finance" FontWeight="SemiBold" />
                                    <TextBlock Text="Free end-of-day data. Good for US stocks and ETFs. May have occasional outages."
                                               TextWrapping="Wrap" FontSize="12"
                                               Foreground="{ThemeResource SystemBaseMediumColor}" />
                                </StackPanel>
                                <Border Grid.Column="2" Background="#667EEA40" CornerRadius="4" Padding="8,4">
                                    <TextBlock Text="Free" FontSize="11" Foreground="#667EEA" />
                                </Border>
                            </Grid>
                        </Border>
                    </RadioButton>

                    <RadioButton x:Name="ProviderStooq" GroupName="Provider">
                        <Border Background="{ThemeResource SystemFillColorNeutralBackgroundBrush}"
                                CornerRadius="8" Padding="16" Width="600">
                            <Grid ColumnSpacing="16">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>
                                <FontIcon Glyph="&#xE9D9;" FontSize="28" Foreground="#ED8936" />
                                <StackPanel Grid.Column="1" Spacing="4">
                                    <TextBlock Text="Stooq" FontWeight="SemiBold" />
                                    <TextBlock Text="Free historical data with good reliability. Supports global markets including US, Europe, and more."
                                               TextWrapping="Wrap" FontSize="12"
                                               Foreground="{ThemeResource SystemBaseMediumColor}" />
                                </StackPanel>
                                <Border Grid.Column="2" Background="#667EEA40" CornerRadius="4" Padding="8,4">
                                    <TextBlock Text="Free" FontSize="11" Foreground="#667EEA" />
                                </Border>
                            </Grid>
                        </Border>
                    </RadioButton>

                    <RadioButton x:Name="ProviderAlpaca" GroupName="Provider">
                        <Border Background="{ThemeResource SystemFillColorNeutralBackgroundBrush}"
                                CornerRadius="8" Padding="16" Width="600">
                            <Grid ColumnSpacing="16">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>
                                <FontIcon Glyph="&#xE8F1;" FontSize="28" Foreground="#00D395" />
                                <StackPanel Grid.Column="1" Spacing="4">
                                    <TextBlock Text="Alpaca Markets" FontWeight="SemiBold" />
                                    <TextBlock Text="High-quality data with intraday support. Requires free account. Best for active traders."
                                               TextWrapping="Wrap" FontSize="12"
                                               Foreground="{ThemeResource SystemBaseMediumColor}" />
                                </StackPanel>
                                <Border Grid.Column="2" Background="#ED893640" CornerRadius="4" Padding="8,4">
                                    <TextBlock Text="Account Required" FontSize="11" Foreground="#ED8936" />
                                </Border>
                            </Grid>
                        </Border>
                    </RadioButton>
                </StackPanel>

                <!-- Options -->
                <StackPanel Spacing="8" Margin="0,8,0,0">
                    <CheckBox x:Name="AdjustedPricesCheck" IsChecked="True"
                              Content="Use adjusted prices (recommended)" />
                    <TextBlock Text="Adjusted prices account for stock splits and dividends"
                               Margin="28,0,0,0" FontSize="11"
                               Foreground="{ThemeResource SystemBaseMediumColor}" />
                    <CheckBox x:Name="SkipExistingCheck" IsChecked="True"
                              Content="Skip existing data (faster)" />
                    <TextBlock Text="Only download data you don't already have"
                               Margin="28,0,0,0" FontSize="11"
                               Foreground="{ThemeResource SystemBaseMediumColor}" />
                </StackPanel>
            </StackPanel>

            <!-- Step 4: Review -->
            <StackPanel x:Name="Step4Panel" Spacing="16" Visibility="Collapsed">
                <TextBlock Text="Review your backfill settings"
                           Style="{StaticResource SubtitleTextBlockStyle}" />
                <TextBlock Text="Please review your settings before starting the download."
                           Foreground="{ThemeResource SystemBaseMediumColor}" TextWrapping="Wrap" />

                <Border Background="{ThemeResource SystemFillColorNeutralBackgroundBrush}"
                        CornerRadius="8" Padding="20">
                    <Grid RowSpacing="16">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="140" />
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>

                        <TextBlock Grid.Row="0" Grid.Column="0" Text="Symbols:" FontWeight="SemiBold" />
                        <TextBlock x:Name="ReviewSymbols" Grid.Row="0" Grid.Column="1" TextWrapping="Wrap" />

                        <TextBlock Grid.Row="1" Grid.Column="0" Text="Date Range:" FontWeight="SemiBold" />
                        <TextBlock x:Name="ReviewDateRange" Grid.Row="1" Grid.Column="1" />

                        <TextBlock Grid.Row="2" Grid.Column="0" Text="Provider:" FontWeight="SemiBold" />
                        <TextBlock x:Name="ReviewProvider" Grid.Row="2" Grid.Column="1" />

                        <TextBlock Grid.Row="3" Grid.Column="0" Text="Options:" FontWeight="SemiBold" />
                        <TextBlock x:Name="ReviewOptions" Grid.Row="3" Grid.Column="1" TextWrapping="Wrap" />

                        <TextBlock Grid.Row="4" Grid.Column="0" Text="Estimated Size:" FontWeight="SemiBold" />
                        <TextBlock x:Name="ReviewEstimate" Grid.Row="4" Grid.Column="1"
                                   Foreground="{ThemeResource SystemAccentColor}" />
                    </Grid>
                </Border>

                <!-- Estimated Time -->
                <Border Background="{ThemeResource SystemAccentColorLight2}"
                        CornerRadius="8" Padding="16">
                    <StackPanel Orientation="Horizontal" Spacing="12">
                        <FontIcon Glyph="&#xE823;" FontSize="20" />
                        <StackPanel>
                            <TextBlock Text="Estimated Download Time" FontWeight="SemiBold" />
                            <TextBlock x:Name="EstimatedTime" Text="1-2 minutes"
                                       Foreground="{ThemeResource SystemBaseMediumColor}" />
                        </StackPanel>
                    </StackPanel>
                </Border>

                <InfoBar x:Name="ReviewInfoBar" IsOpen="True" IsClosable="False"
                         Severity="Informational" Title="Ready to Download"
                         Message="Click 'Start Download' to begin downloading historical data." />
            </StackPanel>
        </Grid>

        <!-- Back Button -->
        <Button x:Name="BackButton" Grid.Row="2" Content="Back"
                HorizontalAlignment="Left" Margin="0,16,0,0"
                Click="BackButton_Click" Visibility="Collapsed" />
    </Grid>
</ContentDialog>
