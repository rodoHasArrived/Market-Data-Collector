<?xml version="1.0" encoding="utf-8"?>
<Page
    x:Class="MarketDataCollector.Uwp.Views.SetupWizardPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:MarketDataCollector.Uwp.Views"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d"
    Background="{ThemeResource ApplicationPageBackgroundThemeBrush}">

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>

        <!-- Progress Indicator -->
        <Border Grid.Row="0" Background="{ThemeResource SystemFillColorNeutralBackgroundBrush}" Padding="48,24">
            <StackPanel>
                <ProgressBar x:Name="WizardProgress" Value="0" Maximum="100" Height="4" CornerRadius="2" />
                <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Spacing="32" Margin="0,16,0,0">
                    <StackPanel x:Name="Step1Indicator" Orientation="Horizontal" Spacing="8">
                        <Border Width="32" Height="32" CornerRadius="16" Background="{ThemeResource SystemAccentColor}">
                            <TextBlock Text="1" Foreground="White" HorizontalAlignment="Center" VerticalAlignment="Center" FontWeight="SemiBold" />
                        </Border>
                        <TextBlock Text="Preset" VerticalAlignment="Center" />
                    </StackPanel>
                    <StackPanel x:Name="Step2Indicator" Orientation="Horizontal" Spacing="8" Opacity="0.5">
                        <Border Width="32" Height="32" CornerRadius="16" Background="{ThemeResource SystemBaseMediumColor}">
                            <TextBlock Text="2" Foreground="White" HorizontalAlignment="Center" VerticalAlignment="Center" FontWeight="SemiBold" />
                        </Border>
                        <TextBlock Text="Provider" VerticalAlignment="Center" />
                    </StackPanel>
                    <StackPanel x:Name="Step3Indicator" Orientation="Horizontal" Spacing="8" Opacity="0.5">
                        <Border Width="32" Height="32" CornerRadius="16" Background="{ThemeResource SystemBaseMediumColor}">
                            <TextBlock Text="3" Foreground="White" HorizontalAlignment="Center" VerticalAlignment="Center" FontWeight="SemiBold" />
                        </Border>
                        <TextBlock Text="Preflight" VerticalAlignment="Center" />
                    </StackPanel>
                    <StackPanel x:Name="Step4Indicator" Orientation="Horizontal" Spacing="8" Opacity="0.5">
                        <Border Width="32" Height="32" CornerRadius="16" Background="{ThemeResource SystemBaseMediumColor}">
                            <TextBlock Text="4" Foreground="White" HorizontalAlignment="Center" VerticalAlignment="Center" FontWeight="SemiBold" />
                        </Border>
                        <TextBlock Text="Complete" VerticalAlignment="Center" />
                    </StackPanel>
                </StackPanel>
            </StackPanel>
        </Border>

        <!-- Content Area -->
        <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
            <Grid Padding="48,24" MaxWidth="900" HorizontalAlignment="Center">
                <!-- Step 1: Choose Preset -->
                <StackPanel x:Name="Step1Content" Spacing="24">
                    <StackPanel HorizontalAlignment="Center" Spacing="8">
                        <FontIcon Glyph="&#xE74C;" FontSize="48" Foreground="{ThemeResource SystemAccentColor}" HorizontalAlignment="Center" />
                        <TextBlock Text="Choose Your Setup Profile" Style="{StaticResource TitleTextBlockStyle}" HorizontalAlignment="Center" />
                        <TextBlock Text="Select a preset that matches your use case for optimized configuration"
                                   Style="{StaticResource BodyTextBlockStyle}" HorizontalAlignment="Center"
                                   Foreground="{ThemeResource SystemBaseMediumColor}" />
                    </StackPanel>

                    <StackPanel x:Name="PresetCards" Spacing="12">
                        <!-- Day Trader Preset -->
                        <Border x:Name="DayTraderCard" Style="{StaticResource CardStyle}" Padding="20" PointerPressed="PresetCard_PointerPressed" Tag="day-trader">
                            <Grid ColumnSpacing="16">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>
                                <Border Grid.Column="0" Width="56" Height="56" CornerRadius="8" Background="#1A58a6ff">
                                    <FontIcon Glyph="&#xE9D9;" FontSize="28" Foreground="{StaticResource InfoColorBrush}" />
                                </Border>
                                <StackPanel Grid.Column="1" Spacing="4">
                                    <TextBlock Text="Day Trader" FontSize="16" FontWeight="SemiBold" />
                                    <TextBlock Text="Real-time streaming focus with L2 depth for active trading" TextWrapping="Wrap"
                                               Foreground="{ThemeResource SystemBaseMediumColor}" FontSize="13" />
                                    <StackPanel Orientation="Horizontal" Spacing="8" Margin="0,4,0,0">
                                        <Border Background="#1A3fb950" CornerRadius="4" Padding="8,2">
                                            <TextBlock Text="L2 Depth" FontSize="11" Foreground="{StaticResource SuccessColorBrush}" />
                                        </Border>
                                        <Border Background="#1A58a6ff" CornerRadius="4" Padding="8,2">
                                            <TextBlock Text="Real-Time" FontSize="11" Foreground="{StaticResource InfoColorBrush}" />
                                        </Border>
                                        <Border Background="#1Ad29922" CornerRadius="4" Padding="8,2">
                                            <TextBlock Text="5 Symbols" FontSize="11" Foreground="{StaticResource WarningColorBrush}" />
                                        </Border>
                                    </StackPanel>
                                </StackPanel>
                                <RadioButton x:Name="DayTraderRadio" Grid.Column="2" GroupName="Preset" VerticalAlignment="Center" />
                            </Grid>
                        </Border>

                        <!-- Researcher Preset -->
                        <Border x:Name="ResearcherCard" Style="{StaticResource CardStyle}" Padding="20" PointerPressed="PresetCard_PointerPressed" Tag="researcher">
                            <Grid ColumnSpacing="16">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>
                                <Border Grid.Column="0" Width="56" Height="56" CornerRadius="8" Background="#1Aa371f7">
                                    <FontIcon Glyph="&#xE8A1;" FontSize="28" Foreground="{StaticResource AccentPurpleBrush}" />
                                </Border>
                                <StackPanel Grid.Column="1" Spacing="4">
                                    <TextBlock Text="Researcher" FontSize="16" FontWeight="SemiBold" />
                                    <TextBlock Text="Historical data focus for backtesting and analysis" TextWrapping="Wrap"
                                               Foreground="{ThemeResource SystemBaseMediumColor}" FontSize="13" />
                                    <StackPanel Orientation="Horizontal" Spacing="8" Margin="0,4,0,0">
                                        <Border Background="#1Aa371f7" CornerRadius="4" Padding="8,2">
                                            <TextBlock Text="Historical" FontSize="11" Foreground="{StaticResource AccentPurpleBrush}" />
                                        </Border>
                                        <Border Background="#1A3fb950" CornerRadius="4" Padding="8,2">
                                            <TextBlock Text="Backfill" FontSize="11" Foreground="{StaticResource SuccessColorBrush}" />
                                        </Border>
                                    </StackPanel>
                                </StackPanel>
                                <RadioButton x:Name="ResearcherRadio" Grid.Column="2" GroupName="Preset" VerticalAlignment="Center" />
                            </Grid>
                        </Border>

                        <!-- Data Archivist Preset -->
                        <Border x:Name="ArchivistCard" Style="{StaticResource CardStyle}" Padding="20" PointerPressed="PresetCard_PointerPressed" Tag="data-archivist">
                            <Grid ColumnSpacing="16">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>
                                <Border Grid.Column="0" Width="56" Height="56" CornerRadius="8" Background="#1Ad29922">
                                    <FontIcon Glyph="&#xE8B7;" FontSize="28" Foreground="{StaticResource WarningColorBrush}" />
                                </Border>
                                <StackPanel Grid.Column="1" Spacing="4">
                                    <TextBlock Text="Data Archivist" FontSize="16" FontWeight="SemiBold" />
                                    <TextBlock Text="Comprehensive collection and long-term storage" TextWrapping="Wrap"
                                               Foreground="{ThemeResource SystemBaseMediumColor}" FontSize="13" />
                                    <StackPanel Orientation="Horizontal" Spacing="8" Margin="0,4,0,0">
                                        <Border Background="#1A3fb950" CornerRadius="4" Padding="8,2">
                                            <TextBlock Text="Full Coverage" FontSize="11" Foreground="{StaticResource SuccessColorBrush}" />
                                        </Border>
                                        <Border Background="#1Ad29922" CornerRadius="4" Padding="8,2">
                                            <TextBlock Text="8 Symbols" FontSize="11" Foreground="{StaticResource WarningColorBrush}" />
                                        </Border>
                                        <Border Background="#1A58a6ff" CornerRadius="4" Padding="8,2">
                                            <TextBlock Text="Tiered Storage" FontSize="11" Foreground="{StaticResource InfoColorBrush}" />
                                        </Border>
                                    </StackPanel>
                                </StackPanel>
                                <RadioButton x:Name="ArchivistRadio" Grid.Column="2" GroupName="Preset" VerticalAlignment="Center" />
                            </Grid>
                        </Border>

                        <!-- Minimal Preset -->
                        <Border x:Name="MinimalCard" Style="{StaticResource CardStyle}" Padding="20" PointerPressed="PresetCard_PointerPressed" Tag="minimal">
                            <Grid ColumnSpacing="16">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>
                                <Border Grid.Column="0" Width="56" Height="56" CornerRadius="8" Background="{ThemeResource SystemFillColorNeutralBackgroundBrush}">
                                    <FontIcon Glyph="&#xE74C;" FontSize="28" Foreground="{ThemeResource SystemBaseMediumColor}" />
                                </Border>
                                <StackPanel Grid.Column="1" Spacing="4">
                                    <TextBlock Text="Minimal Setup" FontSize="16" FontWeight="SemiBold" />
                                    <TextBlock Text="Basic configuration for testing and evaluation" TextWrapping="Wrap"
                                               Foreground="{ThemeResource SystemBaseMediumColor}" FontSize="13" />
                                    <StackPanel Orientation="Horizontal" Spacing="8" Margin="0,4,0,0">
                                        <Border Background="{ThemeResource SystemFillColorNeutralBackgroundBrush}" CornerRadius="4" Padding="8,2">
                                            <TextBlock Text="SPY Only" FontSize="11" />
                                        </Border>
                                        <Border Background="{ThemeResource SystemFillColorNeutralBackgroundBrush}" CornerRadius="4" Padding="8,2">
                                            <TextBlock Text="Trades Only" FontSize="11" />
                                        </Border>
                                    </StackPanel>
                                </StackPanel>
                                <RadioButton x:Name="MinimalRadio" Grid.Column="2" GroupName="Preset" VerticalAlignment="Center" />
                            </Grid>
                        </Border>
                    </StackPanel>
                </StackPanel>

                <!-- Step 2: Configure Provider -->
                <StackPanel x:Name="Step2Content" Spacing="24" Visibility="Collapsed">
                    <StackPanel HorizontalAlignment="Center" Spacing="8">
                        <FontIcon Glyph="&#xE703;" FontSize="48" Foreground="{ThemeResource SystemAccentColor}" HorizontalAlignment="Center" />
                        <TextBlock Text="Configure Your Data Provider" Style="{StaticResource TitleTextBlockStyle}" HorizontalAlignment="Center" />
                        <TextBlock x:Name="Step2Description" Text="Enter your API credentials to connect"
                                   Style="{StaticResource BodyTextBlockStyle}" HorizontalAlignment="Center"
                                   Foreground="{ThemeResource SystemBaseMediumColor}" />
                    </StackPanel>

                    <!-- Provider Selection -->
                    <Border Style="{StaticResource CardStyle}">
                        <StackPanel Spacing="16">
                            <TextBlock Text="Select Provider" FontWeight="SemiBold" />
                            <ComboBox x:Name="ProviderCombo" SelectionChanged="ProviderCombo_SelectionChanged" MinWidth="300">
                                <ComboBoxItem Content="Interactive Brokers" Tag="IB" />
                                <ComboBoxItem Content="StockSharp (Multi-Exchange)" Tag="StockSharp" />
                                <ComboBoxItem Content="Alpaca Markets" Tag="Alpaca" />
                                <ComboBoxItem Content="Polygon.io" Tag="Polygon" />
                                <ComboBoxItem Content="Tiingo" Tag="Tiingo" />
                                <ComboBoxItem Content="Finnhub" Tag="Finnhub" />
                                <ComboBoxItem Content="Alpha Vantage" Tag="AlphaVantage" />
                            </ComboBox>
                        </StackPanel>
                    </Border>

                    <!-- Credentials Panel -->
                    <Border x:Name="CredentialsCard" Style="{StaticResource CardStyle}">
                        <StackPanel Spacing="16">
                            <StackPanel Orientation="Horizontal" Spacing="8">
                                <FontIcon Glyph="&#xE72E;" FontSize="20" Foreground="{ThemeResource SystemAccentColor}" />
                                <TextBlock Text="API Credentials" FontWeight="SemiBold" />
                            </StackPanel>

                            <!-- Alpaca Credentials -->
                            <StackPanel x:Name="AlpacaCredentialsPanel" Spacing="12" Visibility="Collapsed">
                                <TextBox x:Name="AlpacaKeyIdBox" Header="API Key ID" PlaceholderText="Enter your Alpaca API Key ID" />
                                <PasswordBox x:Name="AlpacaSecretKeyBox" Header="Secret Key" PlaceholderText="Enter your Alpaca Secret Key" />
                                <CheckBox x:Name="AlpacaSandboxCheck" Content="Use Paper Trading (Sandbox)" IsChecked="True" />
                            </StackPanel>

                            <!-- Polygon Credentials -->
                            <StackPanel x:Name="PolygonCredentialsPanel" Spacing="12" Visibility="Collapsed">
                                <TextBox x:Name="PolygonApiKeyBox" Header="API Key" PlaceholderText="Enter your Polygon.io API Key" />
                            </StackPanel>

                            <!-- IB Credentials -->
                            <StackPanel x:Name="IBCredentialsPanel" Spacing="12" Visibility="Collapsed">
                                <TextBox x:Name="IBHostBox" Header="TWS/Gateway Host" PlaceholderText="127.0.0.1" Text="127.0.0.1" />
                                <NumberBox x:Name="IBPortBox" Header="Port" Value="7496" Minimum="1" Maximum="65535" SpinButtonPlacementMode="Inline" />
                                <CheckBox x:Name="IBPaperCheck" Content="Use Paper Trading Account" />
                            </StackPanel>

                            <!-- StockSharp Connector Wizard -->
                            <StackPanel x:Name="StockSharpCredentialsPanel" Spacing="12" Visibility="Collapsed">
                                <TextBlock Text="StockSharp Connector Wizard" FontWeight="SemiBold" />
                                <ComboBox x:Name="StockSharpConnectorCombo" SelectionChanged="StockSharpConnector_SelectionChanged">
                                    <ComboBoxItem Content="Rithmic (Futures)" Tag="Rithmic" />
                                    <ComboBoxItem Content="IQFeed (Equities/Options)" Tag="IQFeed" />
                                    <ComboBoxItem Content="CQG (Futures/Options)" Tag="CQG" />
                                    <ComboBoxItem Content="Interactive Brokers (Multi-Asset)" Tag="InteractiveBrokers" />
                                    <ComboBoxItem Content="Custom Adapter (90+ Sources)" Tag="Custom" />
                                </ComboBox>

                                <StackPanel x:Name="StockSharpAdapterPanel" Spacing="8" Visibility="Collapsed">
                                    <TextBox x:Name="StockSharpAdapterTypeBox" Header="Adapter Type" PlaceholderText="StockSharp.Binance.BinanceMessageAdapter" />
                                    <TextBox x:Name="StockSharpAdapterAssemblyBox" Header="Adapter Assembly" PlaceholderText="StockSharp.Binance" />
                                    <TextBox x:Name="StockSharpConnectionParamsBox" Header="Connection Params (key=value, comma-separated)" PlaceholderText="ApiKey=..., Secret=..., UseSandbox=true" />
                                </StackPanel>

                                <TextBox x:Name="StockSharpStoragePathBox" Header="Storage Path" Text="data/stocksharp/{connector}" />

                                <StackPanel Orientation="Horizontal" Spacing="16">
                                    <CheckBox x:Name="StockSharpRealTimeCheck" Content="Enable Real-Time" IsChecked="True" />
                                    <CheckBox x:Name="StockSharpHistoricalCheck" Content="Enable Historical" IsChecked="True" />
                                    <CheckBox x:Name="StockSharpBinaryCheck" Content="Use Binary Storage" />
                                </StackPanel>

                                <!-- StockSharp: Rithmic -->
                                <StackPanel x:Name="StockSharpRithmicPanel" Spacing="8" Visibility="Collapsed">
                                    <TextBox x:Name="RithmicServerBox" Header="Rithmic Server" Text="Rithmic Test" />
                                    <TextBox x:Name="RithmicUserBox" Header="Rithmic Username" />
                                    <PasswordBox x:Name="RithmicPasswordBox" Header="Rithmic Password" />
                                    <TextBox x:Name="RithmicCertBox" Header="Certificate File" PlaceholderText="path/to/cert.pem" />
                                    <CheckBox x:Name="RithmicPaperCheck" Content="Use Paper Trading" IsChecked="True" />
                                </StackPanel>

                                <!-- StockSharp: IQFeed -->
                                <StackPanel x:Name="StockSharpIqFeedPanel" Spacing="8" Visibility="Collapsed">
                                    <TextBox x:Name="IqFeedHostBox" Header="IQFeed Host" Text="127.0.0.1" />
                                    <NumberBox x:Name="IqFeedLevel1PortBox" Header="Level 1 Port" Value="9100" Minimum="1" Maximum="65535" SpinButtonPlacementMode="Inline" />
                                    <NumberBox x:Name="IqFeedLevel2PortBox" Header="Level 2 Port" Value="9200" Minimum="1" Maximum="65535" SpinButtonPlacementMode="Inline" />
                                    <NumberBox x:Name="IqFeedLookupPortBox" Header="Lookup Port" Value="9300" Minimum="1" Maximum="65535" SpinButtonPlacementMode="Inline" />
                                    <TextBox x:Name="IqFeedProductIdBox" Header="Product ID" />
                                    <TextBox x:Name="IqFeedProductVersionBox" Header="Product Version" Text="1.0" />
                                </StackPanel>

                                <!-- StockSharp: CQG -->
                                <StackPanel x:Name="StockSharpCqgPanel" Spacing="8" Visibility="Collapsed">
                                    <TextBox x:Name="CqgUserBox" Header="CQG Username" />
                                    <PasswordBox x:Name="CqgPasswordBox" Header="CQG Password" />
                                    <CheckBox x:Name="CqgDemoCheck" Content="Use Demo Server" IsChecked="True" />
                                </StackPanel>

                                <!-- StockSharp: Interactive Brokers -->
                                <StackPanel x:Name="StockSharpIbPanel" Spacing="8" Visibility="Collapsed">
                                    <TextBox x:Name="StockSharpIbHostBox" Header="TWS/Gateway Host" Text="127.0.0.1" />
                                    <NumberBox x:Name="StockSharpIbPortBox" Header="Port" Value="7496" Minimum="1" Maximum="65535" SpinButtonPlacementMode="Inline" />
                                    <NumberBox x:Name="StockSharpIbClientIdBox" Header="Client ID" Value="1" Minimum="1" Maximum="99999" SpinButtonPlacementMode="Inline" />
                                </StackPanel>
                            </StackPanel>

                            <!-- Generic API Key -->
                            <StackPanel x:Name="GenericCredentialsPanel" Spacing="12" Visibility="Collapsed">
                                <TextBox x:Name="GenericApiKeyBox" Header="API Key/Token" PlaceholderText="Enter your API key" />
                            </StackPanel>

                            <!-- Test Connection Button -->
                            <StackPanel Orientation="Horizontal" Spacing="12">
                                <Button x:Name="TestConnectionButton" Click="TestConnection_Click" Style="{StaticResource AccentButtonStyle}">
                                    <StackPanel Orientation="Horizontal" Spacing="8">
                                        <FontIcon Glyph="&#xE703;" FontSize="14" />
                                        <TextBlock Text="Test Connection" />
                                    </StackPanel>
                                </Button>
                                <ProgressRing x:Name="TestConnectionProgress" IsActive="False" Width="20" Height="20" />
                            </StackPanel>

                            <InfoBar x:Name="ConnectionTestInfoBar" IsOpen="False" IsClosable="True" />
                        </StackPanel>
                    </Border>
                </StackPanel>

                <!-- Step 3: Preflight Checks -->
                <StackPanel x:Name="Step3Content" Spacing="24" Visibility="Collapsed">
                    <StackPanel HorizontalAlignment="Center" Spacing="8">
                        <FontIcon Glyph="&#xE9F5;" FontSize="48" Foreground="{ThemeResource SystemAccentColor}" HorizontalAlignment="Center" />
                        <TextBlock Text="Preflight Checks" Style="{StaticResource TitleTextBlockStyle}" HorizontalAlignment="Center" />
                        <TextBlock Text="Verifying your system is ready for data collection"
                                   Style="{StaticResource BodyTextBlockStyle}" HorizontalAlignment="Center"
                                   Foreground="{ThemeResource SystemBaseMediumColor}" />
                    </StackPanel>

                    <Border Style="{StaticResource CardStyle}">
                        <StackPanel Spacing="16">
                            <StackPanel Orientation="Horizontal" Spacing="12">
                                <Button x:Name="RunPreflightButton" Click="RunPreflight_Click" Style="{StaticResource AccentButtonStyle}">
                                    <StackPanel Orientation="Horizontal" Spacing="8">
                                        <FontIcon Glyph="&#xE768;" FontSize="14" />
                                        <TextBlock Text="Run Preflight Checks" />
                                    </StackPanel>
                                </Button>
                                <ProgressRing x:Name="PreflightProgress" IsActive="False" Width="24" Height="24" />
                            </StackPanel>

                            <!-- Check Results -->
                            <StackPanel x:Name="PreflightResults" Spacing="12">
                                <!-- Network Check -->
                                <Grid x:Name="NetworkCheckItem" ColumnSpacing="12">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto" />
                                        <ColumnDefinition Width="*" />
                                        <ColumnDefinition Width="Auto" />
                                    </Grid.ColumnDefinitions>
                                    <FontIcon x:Name="NetworkCheckIcon" Grid.Column="0" Glyph="&#xE8D8;" FontSize="20" Foreground="{ThemeResource SystemBaseMediumColor}" />
                                    <StackPanel Grid.Column="1">
                                        <TextBlock Text="Network Connectivity" FontWeight="SemiBold" />
                                        <TextBlock x:Name="NetworkCheckMessage" Text="Not checked" Foreground="{ThemeResource SystemBaseMediumColor}" FontSize="12" />
                                    </StackPanel>
                                    <Border x:Name="NetworkCheckBadge" Grid.Column="2" Background="{ThemeResource SystemFillColorNeutralBackgroundBrush}" CornerRadius="4" Padding="8,4">
                                        <TextBlock x:Name="NetworkCheckStatus" Text="Pending" FontSize="11" />
                                    </Border>
                                </Grid>

                                <!-- Disk Space Check -->
                                <Grid x:Name="DiskCheckItem" ColumnSpacing="12">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto" />
                                        <ColumnDefinition Width="*" />
                                        <ColumnDefinition Width="Auto" />
                                    </Grid.ColumnDefinitions>
                                    <FontIcon x:Name="DiskCheckIcon" Grid.Column="0" Glyph="&#xE958;" FontSize="20" Foreground="{ThemeResource SystemBaseMediumColor}" />
                                    <StackPanel Grid.Column="1">
                                        <TextBlock Text="Disk Space" FontWeight="SemiBold" />
                                        <TextBlock x:Name="DiskCheckMessage" Text="Not checked" Foreground="{ThemeResource SystemBaseMediumColor}" FontSize="12" />
                                    </StackPanel>
                                    <Border x:Name="DiskCheckBadge" Grid.Column="2" Background="{ThemeResource SystemFillColorNeutralBackgroundBrush}" CornerRadius="4" Padding="8,4">
                                        <TextBlock x:Name="DiskCheckStatus" Text="Pending" FontSize="11" />
                                    </Border>
                                </Grid>

                                <!-- Storage Permissions Check -->
                                <Grid x:Name="PermissionsCheckItem" ColumnSpacing="12">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto" />
                                        <ColumnDefinition Width="*" />
                                        <ColumnDefinition Width="Auto" />
                                    </Grid.ColumnDefinitions>
                                    <FontIcon x:Name="PermissionsCheckIcon" Grid.Column="0" Glyph="&#xE8D7;" FontSize="20" Foreground="{ThemeResource SystemBaseMediumColor}" />
                                    <StackPanel Grid.Column="1">
                                        <TextBlock Text="Storage Permissions" FontWeight="SemiBold" />
                                        <TextBlock x:Name="PermissionsCheckMessage" Text="Not checked" Foreground="{ThemeResource SystemBaseMediumColor}" FontSize="12" />
                                    </StackPanel>
                                    <Border x:Name="PermissionsCheckBadge" Grid.Column="2" Background="{ThemeResource SystemFillColorNeutralBackgroundBrush}" CornerRadius="4" Padding="8,4">
                                        <TextBlock x:Name="PermissionsCheckStatus" Text="Pending" FontSize="11" />
                                    </Border>
                                </Grid>

                                <!-- Collector Service Check -->
                                <Grid x:Name="ServiceCheckItem" ColumnSpacing="12">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto" />
                                        <ColumnDefinition Width="*" />
                                        <ColumnDefinition Width="Auto" />
                                    </Grid.ColumnDefinitions>
                                    <FontIcon x:Name="ServiceCheckIcon" Grid.Column="0" Glyph="&#xE912;" FontSize="20" Foreground="{ThemeResource SystemBaseMediumColor}" />
                                    <StackPanel Grid.Column="1">
                                        <TextBlock Text="Collector Service" FontWeight="SemiBold" />
                                        <TextBlock x:Name="ServiceCheckMessage" Text="Not checked" Foreground="{ThemeResource SystemBaseMediumColor}" FontSize="12" />
                                    </StackPanel>
                                    <Border x:Name="ServiceCheckBadge" Grid.Column="2" Background="{ThemeResource SystemFillColorNeutralBackgroundBrush}" CornerRadius="4" Padding="8,4">
                                        <TextBlock x:Name="ServiceCheckStatus" Text="Pending" FontSize="11" />
                                    </Border>
                                </Grid>

                                <!-- Provider Connection Check -->
                                <Grid x:Name="ProviderCheckItem" ColumnSpacing="12">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto" />
                                        <ColumnDefinition Width="*" />
                                        <ColumnDefinition Width="Auto" />
                                    </Grid.ColumnDefinitions>
                                    <FontIcon x:Name="ProviderCheckIcon" Grid.Column="0" Glyph="&#xE703;" FontSize="20" Foreground="{ThemeResource SystemBaseMediumColor}" />
                                    <StackPanel Grid.Column="1">
                                        <TextBlock Text="Provider Connection" FontWeight="SemiBold" />
                                        <TextBlock x:Name="ProviderCheckMessage" Text="Not checked" Foreground="{ThemeResource SystemBaseMediumColor}" FontSize="12" />
                                    </StackPanel>
                                    <Border x:Name="ProviderCheckBadge" Grid.Column="2" Background="{ThemeResource SystemFillColorNeutralBackgroundBrush}" CornerRadius="4" Padding="8,4">
                                        <TextBlock x:Name="ProviderCheckStatus" Text="Pending" FontSize="11" />
                                    </Border>
                                </Grid>
                            </StackPanel>

                            <InfoBar x:Name="PreflightInfoBar" IsOpen="False" IsClosable="True" />
                        </StackPanel>
                    </Border>
                </StackPanel>

                <!-- Step 4: Complete -->
                <StackPanel x:Name="Step4Content" Spacing="24" Visibility="Collapsed">
                    <StackPanel HorizontalAlignment="Center" Spacing="16">
                        <FontIcon Glyph="&#xE73E;" FontSize="72" Foreground="{StaticResource SuccessColorBrush}" HorizontalAlignment="Center" />
                        <TextBlock Text="Setup Complete!" Style="{StaticResource TitleTextBlockStyle}" HorizontalAlignment="Center" />
                        <TextBlock Text="Your Market Data Collector is configured and ready to go"
                                   Style="{StaticResource SubtitleTextBlockStyle}" HorizontalAlignment="Center" TextAlignment="Center"
                                   Foreground="{ThemeResource SystemBaseMediumColor}" />
                    </StackPanel>

                    <!-- Configuration Summary -->
                    <Border Style="{StaticResource CardStyle}">
                        <StackPanel Spacing="16">
                            <TextBlock Text="Configuration Summary" FontWeight="SemiBold" />

                            <Grid RowSpacing="12">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="150" />
                                    <ColumnDefinition Width="*" />
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                </Grid.RowDefinitions>

                                <TextBlock Grid.Row="0" Grid.Column="0" Text="Setup Profile:" Foreground="{ThemeResource SystemBaseMediumColor}" />
                                <TextBlock x:Name="SummaryPreset" Grid.Row="0" Grid.Column="1" FontWeight="SemiBold" />

                                <TextBlock Grid.Row="1" Grid.Column="0" Text="Data Provider:" Foreground="{ThemeResource SystemBaseMediumColor}" />
                                <TextBlock x:Name="SummaryProvider" Grid.Row="1" Grid.Column="1" FontWeight="SemiBold" />

                                <TextBlock Grid.Row="2" Grid.Column="0" Text="Symbols:" Foreground="{ThemeResource SystemBaseMediumColor}" />
                                <TextBlock x:Name="SummarySymbols" Grid.Row="2" Grid.Column="1" FontWeight="SemiBold" TextWrapping="Wrap" />

                                <TextBlock Grid.Row="3" Grid.Column="0" Text="Data Types:" Foreground="{ThemeResource SystemBaseMediumColor}" />
                                <TextBlock x:Name="SummaryDataTypes" Grid.Row="3" Grid.Column="1" FontWeight="SemiBold" />
                            </Grid>
                        </StackPanel>
                    </Border>

                    <!-- Next Steps -->
                    <Border Style="{StaticResource CardStyle}">
                        <StackPanel Spacing="16">
                            <TextBlock Text="What's Next?" FontWeight="SemiBold" />

                            <StackPanel Spacing="12">
                                <StackPanel Orientation="Horizontal" Spacing="12">
                                    <Border Width="32" Height="32" CornerRadius="16" Background="{ThemeResource SystemAccentColor}">
                                        <TextBlock Text="1" Foreground="White" HorizontalAlignment="Center" VerticalAlignment="Center" />
                                    </Border>
                                    <StackPanel>
                                        <TextBlock Text="Start Collecting Data" FontWeight="SemiBold" />
                                        <TextBlock Text="Click 'Start Collector' on the dashboard to begin streaming" Foreground="{ThemeResource SystemBaseMediumColor}" FontSize="12" />
                                    </StackPanel>
                                </StackPanel>

                                <StackPanel Orientation="Horizontal" Spacing="12">
                                    <Border Width="32" Height="32" CornerRadius="16" Background="{ThemeResource SystemBaseMediumColor}">
                                        <TextBlock Text="2" Foreground="White" HorizontalAlignment="Center" VerticalAlignment="Center" />
                                    </Border>
                                    <StackPanel>
                                        <TextBlock Text="Download Historical Data" FontWeight="SemiBold" />
                                        <TextBlock Text="Use Backfill to download years of historical data" Foreground="{ThemeResource SystemBaseMediumColor}" FontSize="12" />
                                    </StackPanel>
                                </StackPanel>

                                <StackPanel Orientation="Horizontal" Spacing="12">
                                    <Border Width="32" Height="32" CornerRadius="16" Background="{ThemeResource SystemBaseMediumColor}">
                                        <TextBlock Text="3" Foreground="White" HorizontalAlignment="Center" VerticalAlignment="Center" />
                                    </Border>
                                    <StackPanel>
                                        <TextBlock Text="Monitor Your Data" FontWeight="SemiBold" />
                                        <TextBlock Text="Check data quality, storage usage, and system health" Foreground="{ThemeResource SystemBaseMediumColor}" FontSize="12" />
                                    </StackPanel>
                                </StackPanel>
                            </StackPanel>
                        </StackPanel>
                    </Border>
                </StackPanel>
            </Grid>
        </ScrollViewer>

        <!-- Navigation Buttons -->
        <Border Grid.Row="2" Background="{ThemeResource SystemFillColorNeutralBackgroundBrush}" Padding="48,16">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="Auto" />
                </Grid.ColumnDefinitions>

                <Button x:Name="BackButton" Grid.Column="0" Click="Back_Click" Visibility="Collapsed">
                    <StackPanel Orientation="Horizontal" Spacing="8">
                        <FontIcon Glyph="&#xE72B;" FontSize="14" />
                        <TextBlock Text="Back" />
                    </StackPanel>
                </Button>

                <StackPanel Grid.Column="1" HorizontalAlignment="Center">
                    <HyperlinkButton x:Name="SkipButton" Content="Skip setup and go to dashboard" Click="Skip_Click" />
                </StackPanel>

                <Button x:Name="NextButton" Grid.Column="2" Style="{StaticResource AccentButtonStyle}" Click="Next_Click">
                    <StackPanel Orientation="Horizontal" Spacing="8">
                        <TextBlock x:Name="NextButtonText" Text="Continue" />
                        <FontIcon Glyph="&#xE72A;" FontSize="14" />
                    </StackPanel>
                </Button>
            </Grid>
        </Border>
    </Grid>
</Page>
