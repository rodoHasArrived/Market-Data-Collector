// CLI Commands Reference Diagram
// Market Data Collector v1.0.0
// Last Updated: 2026-01-14
//
// This diagram shows all available CLI commands and flags,
// organized by category with usage examples.
//
// Generate: dot -Tpng cli-commands.dot -o cli-commands.png
//           dot -Tsvg cli-commands.dot -o cli-commands.svg

digraph CLICommands {
  rankdir=TB;
  graph [fontname="Helvetica", fontsize=12, bgcolor="white", compound=true, pad=0.5];
  node  [fontname="Helvetica", fontsize=9, shape=box, style="rounded,filled"];
  edge  [fontname="Helvetica", fontsize=8, color="#4a5568"];

  // Title
  labelloc="t";
  label="Market Data Collector - CLI Commands Reference\nAll Available Flags and Options | v1.0.0";

  // Entry Point
  MDC [shape=box, fillcolor="#438dd5", fontcolor="white", width=3,
       label="dotnet run --project src/MarketDataCollector\n\nMarket Data Collector CLI\n.NET 9.0 | Cross-Platform"];

  // Setup Commands
  subgraph cluster_setup {
    label="Setup Commands (First-Time Configuration)";
    color="#805ad5";
    style="rounded";
    bgcolor="#ede9fe";

    WIZARD [fillcolor="#c4b5fd",
            label="--wizard\n\nInteractive 8-step configuration wizard\nGuides through all settings\nGenerates appsettings.json"];

    AUTO_CONFIG [fillcolor="#c4b5fd",
                 label="--auto-config\n\nQuick auto-configuration\nDetects providers from env vars\nGenerates minimal config"];

    GEN_CONFIG [fillcolor="#c4b5fd",
                label="--generate-config <type>\n\nGenerate config templates\nTypes: minimal, full, alpaca,\nbackfill, production, docker"];

    DETECT [fillcolor="#c4b5fd",
            label="--detect-providers\n\nScan environment variables\nShow available providers\nDisplay capabilities"];
  }

  // Diagnostic Commands
  subgraph cluster_diagnostic {
    label="Diagnostic Commands (Health & Validation)";
    color="#2b6cb0";
    style="rounded";
    bgcolor="#dbeafe";

    VAL_CREDS [fillcolor="#93c5fd",
               label="--validate-credentials\n\nTest API credentials\nValidate all providers\nShow account info"];

    TEST_CONN [fillcolor="#93c5fd",
               label="--test-connectivity\n\nTest network connectivity\nCheck DNS resolution\nMeasure response times"];

    QUICK_CHECK [fillcolor="#93c5fd",
                 label="--quick-check\n\nFast health diagnostics\nCheck: disk, symbols,\ncredentials, compression"];

    VAL_CONFIG [fillcolor="#93c5fd",
                label="--validate-config\n\nValidate configuration\nCheck required fields\nNo startup"];

    DRY_RUN [fillcolor="#93c5fd",
             label="--dry-run\n\nTest initialization\nValidate everything\nNo data collection"];
  }

  // Operation Commands
  subgraph cluster_operation {
    label="Operation Commands (Runtime Modes)";
    color="#38a169";
    style="rounded";
    bgcolor="#f0fff4";

    UI_MODE [fillcolor="#68d391",
             label="--ui\n\nEnable web dashboard\nHTTP endpoints active\nReal-time monitoring"];

    HTTP_PORT [fillcolor="#9ae6b4",
               label="--http-port <port>\n\nCustom HTTP port\nDefault: 8080\nUsed with --ui"];

    BACKFILL [fillcolor="#68d391",
              label="--backfill\n\nRun historical backfill\nRequires provider config\nNo streaming"];

    BACKFILL_OPTS [fillcolor="#9ae6b4",
                   label="--backfill-provider <name>\n--backfill-symbols <list>\n--backfill-from <date>\n--backfill-to <date>\n\nBackfill options"];
  }

  // Documentation Commands
  subgraph cluster_docs {
    label="Documentation Commands (Help & Info)";
    color="#ed8936";
    style="rounded";
    bgcolor="#fffaf0";

    SHOW_CONFIG [fillcolor="#fbd38d",
                 label="--show-config\n\nDisplay current config\nMask sensitive values\nShow effective settings"];

    ERROR_CODES [fillcolor="#fbd38d",
                 label="--error-codes\n\nList all error codes\nMDC-XXX-NNN format\nTroubleshooting tips"];

    HELP [fillcolor="#fbd38d",
          label="--help\n\nShow all commands\nUsage examples\nVersion info"];

    VERSION [fillcolor="#fbd38d",
             label="--version\n\nShow version: 1.0.0\n.NET runtime info"];
  }

  // Common Workflows
  subgraph cluster_workflows {
    label="Common Workflows";
    color="#718096";
    style="rounded";
    bgcolor="#f7fafc";

    WF_NEW [shape=note, fillcolor="#edf2f7",
            label="New Installation:\n\n1. dotnet run -- --wizard\n2. dotnet run -- --validate-credentials\n3. dotnet run -- --dry-run\n4. dotnet run -- --ui"];

    WF_CI [shape=note, fillcolor="#edf2f7",
           label="CI/CD Setup:\n\n1. Set environment variables\n2. dotnet run -- --auto-config\n3. dotnet run -- --validate-config\n4. dotnet run"];

    WF_DEBUG [shape=note, fillcolor="#edf2f7",
              label="Troubleshooting:\n\n1. dotnet run -- --show-config\n2. dotnet run -- --test-connectivity\n3. dotnet run -- --quick-check\n4. dotnet run -- --error-codes"];

    WF_BACKFILL [shape=note, fillcolor="#edf2f7",
                 label="Historical Backfill:\n\n1. dotnet run -- --detect-providers\n2. dotnet run -- --backfill \\\n   --backfill-provider alpaca \\\n   --backfill-symbols SPY,QQQ \\\n   --backfill-from 2024-01-01"];
  }

  // Exit Codes
  subgraph cluster_exit {
    label="Exit Codes";
    color="#e53e3e";
    style="rounded";
    bgcolor="#fee2e2";

    EXIT_CODES [fillcolor="#fecaca",
                label="Exit Codes:\n\n0 - Success\n1 - General error\n2 - Configuration error\n3 - Connection error\n4 - Authentication error\n5 - Validation failed"];
  }

  // Connections
  MDC -> WIZARD [color="#805ad5"];
  MDC -> AUTO_CONFIG [color="#805ad5"];
  MDC -> GEN_CONFIG [color="#805ad5"];
  MDC -> DETECT [color="#805ad5"];

  MDC -> VAL_CREDS [color="#2b6cb0"];
  MDC -> TEST_CONN [color="#2b6cb0"];
  MDC -> QUICK_CHECK [color="#2b6cb0"];
  MDC -> VAL_CONFIG [color="#2b6cb0"];
  MDC -> DRY_RUN [color="#2b6cb0"];

  MDC -> UI_MODE [color="#38a169"];
  MDC -> BACKFILL [color="#38a169"];
  UI_MODE -> HTTP_PORT [style=dashed];
  BACKFILL -> BACKFILL_OPTS [style=dashed];

  MDC -> SHOW_CONFIG [color="#ed8936"];
  MDC -> ERROR_CODES [color="#ed8936"];
  MDC -> HELP [color="#ed8936"];
  MDC -> VERSION [color="#ed8936"];

  // Legend
  subgraph cluster_legend {
    label="Legend";
    style="rounded";
    color="#666666";
    bgcolor="#fafafa";

    L1 [shape=box, fillcolor="#c4b5fd", label="Setup"];
    L2 [shape=box, fillcolor="#93c5fd", label="Diagnostic"];
    L3 [shape=box, fillcolor="#68d391", label="Operation"];
    L4 [shape=box, fillcolor="#fbd38d", label="Documentation"];

    ENV_NOTE [shape=plaintext,
              label="Environment Variables:\n\nALPACA__KEYID, ALPACA__SECRETKEY\nPOLYGON__APIKEY, TIINGO__TOKEN\nNYSE__APIKEY, etc.\n\n(Use double underscore for nested config)"];
  }
}
